[
  {
    "comment": "window - Statement 1",
    "query": "CREATE TEMPORARY TABLE empsalary ( depname varchar, empno bigint, salary int, enroll_date date )",
    "expected": "CREATE TEMPORARY TABLE empsalary (depname VARCHAR, empno BIGINT, salary INT, enroll_date DATE)"
  },
  {
    "comment": "window - Statement 2",
    "query": "INSERT INTO empsalary VALUES ('develop', 10, 5200, '2007-08-01'), ('sales', 1, 5000, '2006-10-01'), ('personnel', 5, 3500, '2007-12-10'), ('sales', 4, 4800, '2007-08-08'), ('personnel', 2, 3900, '2006-12-23'), ('develop', 7, 4200, '2008-01-01'), ('develop', 9, 4500, '2008-01-01'), ('sales', 3, 4800, '2007-08-01'), ('develop', 8, 6000, '2006-10-01'), ('develop', 11, 5200, '2007-08-15')"
  },
  {
    "comment": "window - Statement 3",
    "query": "SELECT depname, empno, salary, sum(salary) OVER (PARTITION BY depname) FROM empsalary ORDER BY depname, salary",
    "expected": "SELECT depname, empno, salary, SUM(salary) OVER (PARTITION BY depname) FROM empsalary ORDER BY depname, salary"
  },
  {
    "comment": "window - Statement 4",
    "query": "SELECT depname, empno, salary, rank() OVER (PARTITION BY depname ORDER BY salary) FROM empsalary",
    "expected": "SELECT depname, empno, salary, RANK() OVER (PARTITION BY depname ORDER BY salary) FROM empsalary"
  },
  {
    "comment": "window - Statement 5",
    "query": "SELECT four, ten, SUM(SUM(four)) OVER (PARTITION BY four), AVG(ten) FROM tenk1 GROUP BY four, ten ORDER BY four, ten"
  },
  {
    "comment": "window - Statement 6",
    "query": "SELECT depname, empno, salary, sum(salary) OVER w FROM empsalary WINDOW w AS (PARTITION BY depname)",
    "expected": "SELECT depname, empno, salary, SUM(salary) OVER w FROM empsalary WINDOW w AS (PARTITION BY depname)"
  },
  {
    "comment": "window - Statement 7",
    "query": "SELECT depname, empno, salary, rank() OVER w FROM empsalary WINDOW w AS (PARTITION BY depname ORDER BY salary) ORDER BY rank() OVER w",
    "expected": "SELECT depname, empno, salary, RANK() OVER w FROM empsalary WINDOW w AS (PARTITION BY depname ORDER BY salary) ORDER BY RANK() OVER w"
  },
  {
    "comment": "window - Statement 8",
    "query": "SELECT COUNT(*) OVER () FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 9",
    "query": "SELECT COUNT(*) OVER w FROM tenk1 WHERE unique2 \u003c 10 WINDOW w AS ()"
  },
  {
    "comment": "window - Statement 10",
    "query": "SELECT four FROM tenk1 WHERE FALSE WINDOW w AS (PARTITION BY ten)"
  },
  {
    "comment": "window - Statement 11",
    "query": "SELECT sum(four) OVER (PARTITION BY ten ORDER BY unique2) AS sum_1, ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT SUM(four) OVER (PARTITION BY ten ORDER BY unique2) AS sum_1, ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 12",
    "query": "SELECT row_number() OVER (ORDER BY unique2) FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT ROW_NUMBER() OVER (ORDER BY unique2) FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 13",
    "query": "SELECT rank() OVER (PARTITION BY four ORDER BY ten) AS rank_1, ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT RANK() OVER (PARTITION BY four ORDER BY ten) AS rank_1, ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 14",
    "query": "SELECT dense_rank() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT DENSE_RANK() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 15",
    "query": "SELECT percent_rank() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT PERCENT_RANK() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 16",
    "query": "SELECT cume_dist() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT CUME_DIST() OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 17",
    "query": "SELECT ntile(3) OVER (ORDER BY ten, four), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT NTILE(3) OVER (ORDER BY ten, four), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 18",
    "query": "SELECT ntile(NULL) OVER (ORDER BY ten, four), ten, four FROM tenk1 LIMIT 2",
    "expected": "SELECT NTILE(NULL) OVER (ORDER BY ten, four), ten, four FROM tenk1 LIMIT 2"
  },
  {
    "comment": "window - Statement 19",
    "query": "SELECT lag(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LAG(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 20",
    "query": "SELECT lag(ten, four) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LAG(ten, four) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 21",
    "query": "SELECT lag(ten, four, 0) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LAG(ten, four, 0) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 22",
    "query": "SELECT lag(ten, four, 0.7) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten",
    "expected": "SELECT LAG(ten, four, 0.7) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten"
  },
  {
    "comment": "window - Statement 23",
    "query": "SELECT lead(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LEAD(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 24",
    "query": "SELECT lead(ten * 2, 1) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LEAD(ten * 2, 1) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 25",
    "query": "SELECT lead(ten * 2, 1, -1) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LEAD(ten * 2, 1, -1) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 26",
    "query": "SELECT lead(ten * 2, 1, -1.4) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten",
    "expected": "SELECT LEAD(ten * 2, 1, -1.4) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten"
  },
  {
    "comment": "window - Statement 27",
    "query": "SELECT first_value(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT FIRST_VALUE(ten) OVER (PARTITION BY four ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 28",
    "query": "SELECT last_value(four) OVER (ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT LAST_VALUE(four) OVER (ORDER BY ten), ten, four FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 29",
    "query": "SELECT last_value(ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten)s ORDER BY four, ten",
    "expected": "SELECT LAST_VALUE(ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) AS s ORDER BY four, ten"
  },
  {
    "comment": "window - Statement 30",
    "query": "SELECT nth_value(ten, four + 1) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten)s",
    "expected": "SELECT NTH_VALUE(ten, four + 1) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) AS s"
  },
  {
    "comment": "window - Statement 31",
    "query": "SELECT ten, two, sum(hundred) AS gsum, sum(sum(hundred)) OVER (PARTITION BY two ORDER BY ten) AS wsum FROM tenk1 GROUP BY ten, two",
    "expected": "SELECT ten, two, SUM(hundred) AS gsum, SUM(SUM(hundred)) OVER (PARTITION BY two ORDER BY ten) AS wsum FROM tenk1 GROUP BY ten, two"
  },
  {
    "comment": "window - Statement 32",
    "query": "SELECT count(*) OVER (PARTITION BY four), four FROM (SELECT * FROM tenk1 WHERE two = 1)s WHERE unique2 \u003c 10",
    "expected": "SELECT COUNT(*) OVER (PARTITION BY four), four FROM (SELECT * FROM tenk1 WHERE two = 1) AS s WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 33",
    "query": "SELECT (count(*) OVER (PARTITION BY four ORDER BY ten) + sum(hundred) OVER (PARTITION BY four ORDER BY ten))::varchar AS cntsum FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT CAST((COUNT(*) OVER (PARTITION BY four ORDER BY ten) + SUM(hundred) OVER (PARTITION BY four ORDER BY ten)) AS VARCHAR) AS cntsum FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 34",
    "query": "SELECT * FROM( SELECT count(*) OVER (PARTITION BY four ORDER BY ten) + sum(hundred) OVER (PARTITION BY two ORDER BY ten) AS total, count(*) OVER (PARTITION BY four ORDER BY ten) AS fourcount, sum(hundred) OVER (PARTITION BY two ORDER BY ten) AS twosum FROM tenk1 )sub WHERE total \u003c\u003e fourcount + twosum",
    "expected": "SELECT * FROM (SELECT COUNT(*) OVER (PARTITION BY four ORDER BY ten) + SUM(hundred) OVER (PARTITION BY two ORDER BY ten) AS total, COUNT(*) OVER (PARTITION BY four ORDER BY ten) AS fourcount, SUM(hundred) OVER (PARTITION BY two ORDER BY ten) AS twosum FROM tenk1) AS sub WHERE total \u003c\u003e fourcount + twosum"
  },
  {
    "comment": "window - Statement 35",
    "query": "SELECT avg(four) OVER (PARTITION BY four ORDER BY thousand / 100) FROM tenk1 WHERE unique2 \u003c 10",
    "expected": "SELECT AVG(four) OVER (PARTITION BY four ORDER BY thousand / 100) FROM tenk1 WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 36",
    "query": "SELECT ten, two, sum(hundred) AS gsum, sum(sum(hundred)) OVER win AS wsum FROM tenk1 GROUP BY ten, two WINDOW win AS (PARTITION BY two ORDER BY ten)",
    "expected": "SELECT ten, two, SUM(hundred) AS gsum, SUM(SUM(hundred)) OVER win AS wsum FROM tenk1 GROUP BY ten, two WINDOW win AS (PARTITION BY two ORDER BY ten)"
  },
  {
    "comment": "window - Statement 37",
    "query": "SELECT sum(salary), row_number() OVER (ORDER BY depname), sum(sum(salary)) OVER (ORDER BY depname DESC) FROM empsalary GROUP BY depname",
    "expected": "SELECT SUM(salary), ROW_NUMBER() OVER (ORDER BY depname), SUM(SUM(salary)) OVER (ORDER BY depname DESC) FROM empsalary GROUP BY depname"
  },
  {
    "comment": "window - Statement 38",
    "query": "SELECT sum(salary) OVER w1, count(*) OVER w2 FROM empsalary WINDOW w1 AS (ORDER BY salary), w2 AS (ORDER BY salary)",
    "expected": "SELECT SUM(salary) OVER w1, COUNT(*) OVER w2 FROM empsalary WINDOW w1 AS (ORDER BY salary), w2 AS (ORDER BY salary)"
  },
  {
    "comment": "window - Statement 39",
    "query": "SELECT lead(ten, (SELECT two FROM tenk1 WHERE s.unique2 = unique2)) OVER (PARTITION BY four ORDER BY ten) FROM tenk1 s WHERE unique2 \u003c 10",
    "expected": "SELECT LEAD(ten, (SELECT two FROM tenk1 WHERE s.unique2 = unique2)) OVER (PARTITION BY four ORDER BY ten) FROM tenk1 AS s WHERE unique2 \u003c 10"
  },
  {
    "comment": "window - Statement 40",
    "query": "SELECT count(*) OVER (PARTITION BY four) FROM (SELECT * FROM tenk1 WHERE FALSE)s",
    "expected": "SELECT COUNT(*) OVER (PARTITION BY four) FROM (SELECT * FROM tenk1 WHERE FALSE) AS s"
  },
  {
    "comment": "window - Statement 41",
    "query": "SELECT sum(salary) OVER w, rank() OVER w FROM empsalary WINDOW w AS (PARTITION BY depname ORDER BY salary DESC)",
    "expected": "SELECT SUM(salary) OVER w, RANK() OVER w FROM empsalary WINDOW w AS (PARTITION BY depname ORDER BY salary DESC)"
  },
  {
    "comment": "window - Statement 42",
    "query": "SELECT empno, depname, salary, bonus, depadj, MIN(bonus) OVER (ORDER BY empno), MAX(depadj) OVER () FROM( SELECT *, CASE WHEN enroll_date \u003c '2008-01-01' THEN 2008 - extract(YEAR FROM enroll_date) END * 500 AS bonus, CASE WHEN AVG(salary) OVER (PARTITION BY depname) \u003c salary THEN 200 END AS depadj FROM empsalary )s",
    "expected": "SELECT empno, depname, salary, bonus, depadj, MIN(bonus) OVER (ORDER BY empno), MAX(depadj) OVER () FROM (SELECT *, CASE WHEN enroll_date \u003c '2008-01-01' THEN 2008 - extract(year FROM enroll_date) END * 500 AS bonus, CASE WHEN AVG(salary) OVER (PARTITION BY depname) \u003c salary THEN 200 END AS depadj FROM empsalary) AS s"
  },
  {
    "comment": "window - Statement 43",
    "query": "SELECT SUM(COUNT(f1)) OVER () FROM int4_tbl WHERE f1=42",
    "expected": "SELECT SUM(COUNT(f1)) OVER () FROM int4_tbl WHERE f1 = 42"
  },
  {
    "comment": "window - Statement 44",
    "query": "select ten, sum(unique1) + sum(unique2) as res, rank() over (order by sum(unique1) + sum(unique2)) as rank from tenk1 group by ten order by ten",
    "expected": "SELECT ten, SUM(unique1) + SUM(unique2) AS res, RANK() OVER (ORDER BY SUM(unique1) + SUM(unique2)) AS rank FROM tenk1 GROUP BY ten ORDER BY ten"
  },
  {
    "comment": "window - Statement 45",
    "query": "explain (costs off) select first_value(max(x)) over (), y from (select unique1 as x, ten+four as y from tenk1) ss group by y",
    "expected": "EXPLAIN (COSTS false) SELECT FIRST_VALUE(MAX(x)) OVER (), y FROM (SELECT unique1 AS x, ten + four AS y FROM tenk1) AS ss GROUP BY y"
  },
  {
    "comment": "window - Statement 46",
    "query": "select x, lag(x, 1) over (order by x), lead(x, 3) over (order by x) from (select x::numeric as x from generate_series(1,10) x)",
    "expected": "SELECT x, LAG(x, 1) OVER (ORDER BY x), LEAD(x, 3) OVER (ORDER BY x) FROM (SELECT CAST(x AS NUMERIC) AS x FROM generate_series(1, 10) AS x)"
  },
  {
    "comment": "window - Statement 47",
    "query": "SELECT four, ten, sum(ten) over (partition by four order by ten), last_value(ten) over (partition by four order by ten) FROM (select distinct ten, four from tenk1) ss",
    "expected": "SELECT four, ten, SUM(ten) OVER (PARTITION BY four ORDER BY ten), LAST_VALUE(ten) OVER (PARTITION BY four ORDER BY ten) FROM (SELECT DISTINCT ten, four FROM tenk1) AS ss"
  },
  {
    "comment": "window - Statement 48",
    "query": "SELECT four, ten, sum(ten) over (partition by four order by ten range between unbounded preceding and current row), last_value(ten) over (partition by four order by ten range between unbounded preceding and current row) FROM (select distinct ten, four from tenk1) ss",
    "expected": "SELECT four, ten, SUM(ten) OVER (PARTITION BY four ORDER BY ten RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), LAST_VALUE(ten) OVER (PARTITION BY four ORDER BY ten RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM (SELECT DISTINCT ten, four FROM tenk1) AS ss"
  },
  {
    "comment": "window - Statement 49",
    "query": "SELECT four, ten, sum(ten) over (partition by four order by ten range between unbounded preceding and unbounded following), last_value(ten) over (partition by four order by ten range between unbounded preceding and unbounded following) FROM (select distinct ten, four from tenk1) ss",
    "expected": "SELECT four, ten, SUM(ten) OVER (PARTITION BY four ORDER BY ten RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), LAST_VALUE(ten) OVER (PARTITION BY four ORDER BY ten RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT DISTINCT ten, four FROM tenk1) AS ss"
  },
  {
    "comment": "window - Statement 50",
    "query": "SELECT four, ten/4 as two, sum(ten/4) over (partition by four order by ten/4 range between unbounded preceding and current row), last_value(ten/4) over (partition by four order by ten/4 range between unbounded preceding and current row) FROM (select distinct ten, four from tenk1) ss",
    "expected": "SELECT four, ten / 4 AS two, SUM(ten / 4) OVER (PARTITION BY four ORDER BY ten / 4 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), LAST_VALUE(ten / 4) OVER (PARTITION BY four ORDER BY ten / 4 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM (SELECT DISTINCT ten, four FROM tenk1) AS ss"
  },
  {
    "comment": "window - Statement 51",
    "query": "SELECT four, ten/4 as two, sum(ten/4) over (partition by four order by ten/4 rows between unbounded preceding and current row), last_value(ten/4) over (partition by four order by ten/4 rows between unbounded preceding and current row) FROM (select distinct ten, four from tenk1) ss",
    "expected": "SELECT four, ten / 4 AS two, SUM(ten / 4) OVER (PARTITION BY four ORDER BY ten / 4 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), LAST_VALUE(ten / 4) OVER (PARTITION BY four ORDER BY ten / 4 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM (SELECT DISTINCT ten, four FROM tenk1) AS ss"
  },
  {
    "comment": "window - Statement 52",
    "query": "SELECT sum(unique1) over (order by four range between current row and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 53",
    "query": "SELECT sum(unique1) over (rows between current row and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 54",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 2 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 55",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 2 following exclude no others), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 56",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 2 following exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 57",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 2 following exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 58",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 2 following exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 59",
    "query": "SELECT first_value(unique1) over (ORDER BY four rows between current row and 2 following exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT FIRST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 60",
    "query": "SELECT first_value(unique1) over (ORDER BY four rows between current row and 2 following exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT FIRST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 61",
    "query": "SELECT first_value(unique1) over (ORDER BY four rows between current row and 2 following exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT FIRST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 62",
    "query": "SELECT last_value(unique1) over (ORDER BY four rows between current row and 2 following exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT LAST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 63",
    "query": "SELECT last_value(unique1) over (ORDER BY four rows between current row and 2 following exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT LAST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 64",
    "query": "SELECT last_value(unique1) over (ORDER BY four rows between current row and 2 following exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT LAST_VALUE(unique1) OVER (ORDER BY four ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 65",
    "query": "SELECT sum(unique1) over (rows between 2 preceding and 1 preceding), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 66",
    "query": "SELECT sum(unique1) over (rows between 1 following and 3 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 1 FOLLOWING AND 3 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 67",
    "query": "SELECT sum(unique1) over (rows between unbounded preceding and 1 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 68",
    "query": "SELECT sum(unique1) over (w range between current row and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (order by four)",
    "expected": "SELECT SUM(unique1) OVER (w RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (ORDER BY four)"
  },
  {
    "comment": "window - Statement 69",
    "query": "SELECT sum(unique1) over (w range between unbounded preceding and current row exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (order by four)",
    "expected": "SELECT SUM(unique1) OVER (w RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (ORDER BY four)"
  },
  {
    "comment": "window - Statement 70",
    "query": "SELECT sum(unique1) over (w range between unbounded preceding and current row exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (order by four)",
    "expected": "SELECT SUM(unique1) OVER (w RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (ORDER BY four)"
  },
  {
    "comment": "window - Statement 71",
    "query": "SELECT sum(unique1) over (w range between unbounded preceding and current row exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (order by four)",
    "expected": "SELECT SUM(unique1) OVER (w RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (ORDER BY four)"
  },
  {
    "comment": "window - Statement 72",
    "query": "SELECT first_value(unique1) over w, nth_value(unique1, 2) over w AS nth_2, last_value(unique1) over w, unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (order by four range between current row and unbounded following)",
    "expected": "SELECT FIRST_VALUE(unique1) OVER w, NTH_VALUE(unique1, 2) OVER w AS nth_2, LAST_VALUE(unique1) OVER w, unique1, four FROM tenk1 WHERE unique1 \u003c 10 WINDOW w AS (ORDER BY four RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)"
  },
  {
    "comment": "window - Statement 73",
    "query": "SELECT sum(unique1) over (order by unique1 rows (SELECT unique1 FROM tenk1 ORDER BY unique1 LIMIT 1) + 1 PRECEDING), unique1 FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY unique1 ROWS (SELECT unique1 FROM tenk1 ORDER BY unique1 LIMIT 1) + 1 PRECEDING), unique1 FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 74",
    "query": "CREATE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i rows between 1 preceding and 1 following) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 75",
    "query": "SELECT * FROM v_window"
  },
  {
    "comment": "window - Statement 76",
    "query": "SELECT pg_get_viewdef('v_window')"
  },
  {
    "comment": "window - Statement 77",
    "query": "CREATE OR REPLACE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i rows between 1 preceding and 1 following exclude current row) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE OR REPLACE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING EXCLUDE CURRENT ROW) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 78",
    "query": "CREATE OR REPLACE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i rows between 1 preceding and 1 following exclude group) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE OR REPLACE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING EXCLUDE GROUP) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 79",
    "query": "CREATE OR REPLACE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i rows between 1 preceding and 1 following exclude ties) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE OR REPLACE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING EXCLUDE TIES) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 80",
    "query": "CREATE OR REPLACE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i rows between 1 preceding and 1 following exclude no others) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE OR REPLACE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 81",
    "query": "CREATE OR REPLACE TEMP VIEW v_window AS SELECT i, sum(i) over (order by i groups between 1 preceding and 1 following) as sum_rows FROM generate_series(1, 10) i",
    "expected": "CREATE OR REPLACE TEMPORARY VIEW v_window AS SELECT i, SUM(i) OVER (ORDER BY i GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS sum_rows FROM generate_series(1, 10) AS i"
  },
  {
    "comment": "window - Statement 82",
    "query": "DROP VIEW v_window"
  },
  {
    "comment": "window - Statement 83",
    "query": "CREATE TEMP VIEW v_window AS SELECT i, min(i) over (order by i range between '1 day' preceding and '10 days' following) as min_i FROM generate_series(now(), now()+'100 days'::interval, '1 hour') i",
    "expected": "CREATE TEMPORARY VIEW v_window AS SELECT i, MIN(i) OVER (ORDER BY i RANGE BETWEEN '1 day' PRECEDING AND '10 days' FOLLOWING) AS min_i FROM generate_series(NOW(), CAST(NOW() + '100 days' AS INTERVAL), '1 hour') AS i"
  },
  {
    "comment": "window - Statement 84",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 1::int2 preceding), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 85",
    "query": "SELECT sum(unique1) over (order by four desc range between 2::int8 preceding and 1::int2 preceding), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four DESC RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 86",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 1::int2 preceding exclude no others), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 87",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 1::int2 preceding exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 88",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 1::int2 preceding exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 89",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 1::int2 preceding exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(1 AS SMALLINT) PRECEDING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 90",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 6::int2 following exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(6 AS SMALLINT) FOLLOWING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 91",
    "query": "SELECT sum(unique1) over (order by four range between 2::int8 preceding and 6::int2 following exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four RANGE BETWEEN CAST(2 AS BIGINT) PRECEDING AND CAST(6 AS SMALLINT) FOLLOWING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 92",
    "query": "SELECT sum(unique1) over (partition by four order by unique1 range between 5::int8 preceding and 6::int2 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY four ORDER BY unique1 RANGE BETWEEN CAST(5 AS BIGINT) PRECEDING AND CAST(6 AS SMALLINT) FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 93",
    "query": "SELECT sum(unique1) over (partition by four order by unique1 range between 5::int8 preceding and 6::int2 following exclude current row),unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY four ORDER BY unique1 RANGE BETWEEN CAST(5 AS BIGINT) PRECEDING AND CAST(6 AS SMALLINT) FOLLOWING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 94",
    "query": "select sum(salary) over (order by enroll_date range between '1 year'::interval preceding and '1 year'::interval following), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 95",
    "query": "select sum(salary) over (order by enroll_date desc range between '1 year'::interval preceding and '1 year'::interval following), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date DESC RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 96",
    "query": "select sum(salary) over (order by enroll_date desc range between '1 year'::interval following and '1 year'::interval following), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date DESC RANGE BETWEEN CAST('1 year' AS INTERVAL) FOLLOWING AND CAST('1 year' AS INTERVAL) FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 97",
    "query": "select sum(salary) over (order by enroll_date range between '1 year'::interval preceding and '1 year'::interval following exclude current row), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE CURRENT ROW), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 98",
    "query": "select sum(salary) over (order by enroll_date range between '1 year'::interval preceding and '1 year'::interval following exclude group), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE GROUP), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 99",
    "query": "select sum(salary) over (order by enroll_date range between '1 year'::interval preceding and '1 year'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 100",
    "query": "select first_value(salary) over(order by salary range between 1000 preceding and 1000 following), lead(salary) over(order by salary range between 1000 preceding and 1000 following), nth_value(salary, 1) over(order by salary range between 1000 preceding and 1000 following), salary from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 PRECEDING AND 1000 FOLLOWING), LEAD(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 PRECEDING AND 1000 FOLLOWING), NTH_VALUE(salary, 1) OVER (ORDER BY salary RANGE BETWEEN 1000 PRECEDING AND 1000 FOLLOWING), salary FROM empsalary"
  },
  {
    "comment": "window - Statement 101",
    "query": "select last_value(salary) over(order by salary range between 1000 preceding and 1000 following), lag(salary) over(order by salary range between 1000 preceding and 1000 following), salary from empsalary",
    "expected": "SELECT LAST_VALUE(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 PRECEDING AND 1000 FOLLOWING), LAG(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 PRECEDING AND 1000 FOLLOWING), salary FROM empsalary"
  },
  {
    "comment": "window - Statement 102",
    "query": "select first_value(salary) over(order by salary range between 1000 following and 3000 following exclude current row), lead(salary) over(order by salary range between 1000 following and 3000 following exclude ties), nth_value(salary, 1) over(order by salary range between 1000 following and 3000 following exclude ties), salary from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 FOLLOWING AND 3000 FOLLOWING EXCLUDE CURRENT ROW), LEAD(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 FOLLOWING AND 3000 FOLLOWING EXCLUDE TIES), NTH_VALUE(salary, 1) OVER (ORDER BY salary RANGE BETWEEN 1000 FOLLOWING AND 3000 FOLLOWING EXCLUDE TIES), salary FROM empsalary"
  },
  {
    "comment": "window - Statement 103",
    "query": "select last_value(salary) over(order by salary range between 1000 following and 3000 following exclude group), lag(salary) over(order by salary range between 1000 following and 3000 following exclude group), salary from empsalary",
    "expected": "SELECT LAST_VALUE(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 FOLLOWING AND 3000 FOLLOWING EXCLUDE GROUP), LAG(salary) OVER (ORDER BY salary RANGE BETWEEN 1000 FOLLOWING AND 3000 FOLLOWING EXCLUDE GROUP), salary FROM empsalary"
  },
  {
    "comment": "window - Statement 104",
    "query": "select first_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude ties), last_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE TIES), LAST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 105",
    "query": "select first_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude ties), last_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE TIES), LAST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 106",
    "query": "select first_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude group), last_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude group), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE GROUP), LAST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE GROUP), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 107",
    "query": "select first_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude current row), last_value(salary) over(order by enroll_date range between unbounded preceding and '1 year'::interval following exclude current row), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE CURRENT ROW), LAST_VALUE(salary) OVER (ORDER BY enroll_date RANGE BETWEEN UNBOUNDED PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING EXCLUDE CURRENT ROW), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 108",
    "query": "select x, y, first_value(y) over w, last_value(y) over w from (select x, x as y from generate_series(1,5) as x union all select null, 42 union all select null, 43) ss window w as (order by x asc nulls first range between 2 preceding and 2 following)",
    "expected": "SELECT x, y, FIRST_VALUE(y) OVER w, LAST_VALUE(y) OVER w FROM ((SELECT x, x AS y FROM generate_series(1, 5) AS x UNION ALL SELECT NULL, 42) UNION ALL SELECT NULL, 43) AS ss WINDOW w AS (ORDER BY x ASC NULLS FIRST RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)"
  },
  {
    "comment": "window - Statement 109",
    "query": "select x, y, first_value(y) over w, last_value(y) over w from (select x, x as y from generate_series(1,5) as x union all select null, 42 union all select null, 43) ss window w as (order by x asc nulls last range between 2 preceding and 2 following)",
    "expected": "SELECT x, y, FIRST_VALUE(y) OVER w, LAST_VALUE(y) OVER w FROM ((SELECT x, x AS y FROM generate_series(1, 5) AS x UNION ALL SELECT NULL, 42) UNION ALL SELECT NULL, 43) AS ss WINDOW w AS (ORDER BY x ASC NULLS LAST RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)"
  },
  {
    "comment": "window - Statement 110",
    "query": "select x, y, first_value(y) over w, last_value(y) over w from (select x, x as y from generate_series(1,5) as x union all select null, 42 union all select null, 43) ss window w as (order by x desc nulls first range between 2 preceding and 2 following)",
    "expected": "SELECT x, y, FIRST_VALUE(y) OVER w, LAST_VALUE(y) OVER w FROM ((SELECT x, x AS y FROM generate_series(1, 5) AS x UNION ALL SELECT NULL, 42) UNION ALL SELECT NULL, 43) AS ss WINDOW w AS (ORDER BY x DESC NULLS FIRST RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)"
  },
  {
    "comment": "window - Statement 111",
    "query": "select x, y, first_value(y) over w, last_value(y) over w from (select x, x as y from generate_series(1,5) as x union all select null, 42 union all select null, 43) ss window w as (order by x desc nulls last range between 2 preceding and 2 following)",
    "expected": "SELECT x, y, FIRST_VALUE(y) OVER w, LAST_VALUE(y) OVER w FROM ((SELECT x, x AS y FROM generate_series(1, 5) AS x UNION ALL SELECT NULL, 42) UNION ALL SELECT NULL, 43) AS ss WINDOW w AS (ORDER BY x DESC NULLS LAST RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)"
  },
  {
    "comment": "window - Statement 112",
    "query": "CREATE FUNCTION unbounded_syntax_test1a(x int) RETURNS TABLE (a int, b int, c int) LANGUAGE SQL BEGIN ATOMIC SELECT sum(unique1) over (rows between x preceding and x following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; END",
    "expected": "CREATE FUNCTION unbounded_syntax_test1a (x INT) LANGUAGE sql BEGIN ATOMIC SELECT SUM(unique1) OVER (ROWS BETWEEN x PRECEDING AND x FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10; END"
  },
  {
    "comment": "window - Statement 114",
    "query": "CREATE FUNCTION unbounded_syntax_test1b(x int) RETURNS TABLE (a int, b int, c int) LANGUAGE SQL AS $$ SELECT sum(unique1) over (rows between x preceding and x following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; $$",
    "expected": "CREATE FUNCTION unbounded_syntax_test1b (x INT) LANGUAGE sql AS $$ SELECT sum(unique1) over (rows between x preceding and x following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; $$"
  },
  {
    "comment": "window - Statement 115",
    "query": "SELECT * FROM unbounded_syntax_test1a(2)"
  },
  {
    "comment": "window - Statement 116",
    "query": "SELECT * FROM unbounded_syntax_test1b(2)"
  },
  {
    "comment": "window - Statement 117",
    "query": "CREATE FUNCTION unbounded_syntax_test2a(unbounded int) RETURNS TABLE (a int, b int, c int) LANGUAGE SQL BEGIN ATOMIC SELECT sum(unique1) over (rows between unbounded preceding and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; END",
    "expected": "CREATE FUNCTION unbounded_syntax_test2a (unbounded INT) LANGUAGE sql BEGIN ATOMIC SELECT SUM(unique1) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10; END"
  },
  {
    "comment": "window - Statement 118",
    "query": "CREATE FUNCTION unbounded_syntax_test2b(unbounded int) RETURNS TABLE (a int, b int, c int) LANGUAGE SQL AS $$ SELECT sum(unique1) over (rows between unbounded preceding and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; $$",
    "expected": "CREATE FUNCTION unbounded_syntax_test2b (unbounded INT) LANGUAGE sql AS $$ SELECT sum(unique1) over (rows between unbounded preceding and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10; $$"
  },
  {
    "comment": "window - Statement 119",
    "query": "SELECT * FROM unbounded_syntax_test2a(2)"
  },
  {
    "comment": "window - Statement 120",
    "query": "SELECT * FROM unbounded_syntax_test2b(2)"
  },
  {
    "comment": "window - Statement 121",
    "query": "DROP FUNCTION unbounded_syntax_test1a, unbounded_syntax_test1b, unbounded_syntax_test2a, unbounded_syntax_test2b"
  },
  {
    "comment": "window - Statement 122",
    "query": "CREATE FUNCTION unbounded(x int) RETURNS int LANGUAGE SQL IMMUTABLE RETURN x",
    "expected": "CREATE FUNCTION unbounded (x INT) RETURNS INT LANGUAGE sql IMMUTABLE RETURN x"
  },
  {
    "comment": "window - Statement 123",
    "query": "SELECT sum(unique1) over (rows between 1 preceding and 1 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 124",
    "query": "SELECT sum(unique1) over (rows between unbounded(1) preceding and unbounded(1) following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN unbounded(1) PRECEDING AND unbounded(1) FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 125",
    "query": "SELECT sum(unique1) over (rows between unbounded.x preceding and unbounded.x following), unique1, four FROM tenk1, (values (1)) as unbounded(x) WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ROWS BETWEEN unbounded.x PRECEDING AND unbounded.x FOLLOWING), unique1, four FROM tenk1, (VALUES (1)) AS unbounded(x) WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 126",
    "query": "DROP FUNCTION unbounded"
  },
  {
    "comment": "window - Statement 127",
    "query": "select x, last_value(x) over (order by x::smallint range between current row and 2147450884 following) from generate_series(32764, 32766) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY CAST(x AS SMALLINT) RANGE BETWEEN CURRENT ROW AND 2147450884 FOLLOWING) FROM generate_series(32764, 32766) AS x"
  },
  {
    "comment": "window - Statement 128",
    "query": "select x, last_value(x) over (order by x::smallint desc range between current row and 2147450885 following) from generate_series(-32766, -32764) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY CAST(x AS SMALLINT) DESC RANGE BETWEEN CURRENT ROW AND 2147450885 FOLLOWING) FROM generate_series(-32766, -32764) AS x"
  },
  {
    "comment": "window - Statement 129",
    "query": "select x, last_value(x) over (order by x range between current row and 4 following) from generate_series(2147483644, 2147483646) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY x RANGE BETWEEN CURRENT ROW AND 4 FOLLOWING) FROM generate_series(2147483644, 2147483646) AS x"
  },
  {
    "comment": "window - Statement 130",
    "query": "select x, last_value(x) over (order by x desc range between current row and 5 following) from generate_series(-2147483646, -2147483644) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY x DESC RANGE BETWEEN CURRENT ROW AND 5 FOLLOWING) FROM generate_series(-2147483646, -2147483644) AS x"
  },
  {
    "comment": "window - Statement 131",
    "query": "select x, last_value(x) over (order by x range between current row and 4 following) from generate_series(9223372036854775804, 9223372036854775806) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY x RANGE BETWEEN CURRENT ROW AND 4 FOLLOWING) FROM generate_series(9223372036854775804, 9223372036854775806) AS x"
  },
  {
    "comment": "window - Statement 132",
    "query": "select x, last_value(x) over (order by x desc range between current row and 5 following) from generate_series(-9223372036854775806, -9223372036854775804) x",
    "expected": "SELECT x, LAST_VALUE(x) OVER (ORDER BY x DESC RANGE BETWEEN CURRENT ROW AND 5 FOLLOWING) FROM generate_series(-9223372036854775806, -9223372036854775804) AS x"
  },
  {
    "comment": "window - Statement 133",
    "query": "create temp table numerics( id int, f_float4 float4, f_float8 float8, f_numeric numeric )",
    "expected": "CREATE TEMPORARY TABLE numerics (id INT, f_float4 REAL, f_float8 FLOAT8, f_numeric NUMERIC)"
  },
  {
    "comment": "window - Statement 134",
    "query": "insert into numerics values (0, '-infinity', '-infinity', '-infinity'), (1, -3, -3, -3), (2, -1, -1, -1), (3, 0, 0, 0), (4, 1.1, 1.1, 1.1), (5, 1.12, 1.12, 1.12), (6, 2, 2, 2), (7, 100, 100, 100), (8, 'infinity', 'infinity', 'infinity'), (9, 'NaN', 'NaN', 'NaN')",
    "expected": "INSERT INTO numerics VALUES (0, '-infinity', '-infinity', '-infinity'), (1, -3, -3, -3), (2, -1, -1, -1), (3, 0, 0, 0), (4, 1.1, 1.1, 1.1), (5, 1.12, 1.12, 1.12), (6, 2, 2, 2), (7, 100, 100, 100), (8, 'infinity', 'infinity', 'infinity'), (9, 'NaN', 'NaN', 'NaN')"
  },
  {
    "comment": "window - Statement 135",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 1 preceding and 1 following)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 136",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 1 preceding and 1.1::float4 following)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 1 PRECEDING AND CAST(1.1 AS REAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 137",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 'inf' preceding and 'inf' following)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 'inf' PRECEDING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 138",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 'inf' preceding and 'inf' preceding)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 'inf' PRECEDING AND 'inf' PRECEDING)"
  },
  {
    "comment": "window - Statement 139",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 'inf' following and 'inf' following)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 'inf' FOLLOWING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 140",
    "query": "select id, f_float4, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float4 range between 1.1 preceding and 'NaN' following)",
    "expected": "SELECT id, f_float4, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float4 RANGE BETWEEN 1.1 PRECEDING AND 'NaN' FOLLOWING)"
  },
  {
    "comment": "window - Statement 141",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 1 preceding and 1 following)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 142",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 1 preceding and 1.1::float8 following)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 1 PRECEDING AND CAST(1.1 AS FLOAT8) FOLLOWING)"
  },
  {
    "comment": "window - Statement 143",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 'inf' preceding and 'inf' following)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 'inf' PRECEDING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 144",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 'inf' preceding and 'inf' preceding)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 'inf' PRECEDING AND 'inf' PRECEDING)"
  },
  {
    "comment": "window - Statement 145",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 'inf' following and 'inf' following)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 'inf' FOLLOWING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 146",
    "query": "select id, f_float8, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_float8 range between 1.1 preceding and 'NaN' following)",
    "expected": "SELECT id, f_float8, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_float8 RANGE BETWEEN 1.1 PRECEDING AND 'NaN' FOLLOWING)"
  },
  {
    "comment": "window - Statement 147",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 1 preceding and 1 following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 148",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 1 preceding and 1.1::numeric following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 1 PRECEDING AND CAST(1.1 AS NUMERIC) FOLLOWING)"
  },
  {
    "comment": "window - Statement 149",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 1 preceding and 1.1::float8 following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 1 PRECEDING AND CAST(1.1 AS FLOAT8) FOLLOWING)"
  },
  {
    "comment": "window - Statement 150",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 'inf' preceding and 'inf' following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 'inf' PRECEDING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 151",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 'inf' preceding and 'inf' preceding)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 'inf' PRECEDING AND 'inf' PRECEDING)"
  },
  {
    "comment": "window - Statement 152",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 'inf' following and 'inf' following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 'inf' FOLLOWING AND 'inf' FOLLOWING)"
  },
  {
    "comment": "window - Statement 153",
    "query": "select id, f_numeric, first_value(id) over w, last_value(id) over w from numerics window w as (order by f_numeric range between 1.1 preceding and 'NaN' following)",
    "expected": "SELECT id, f_numeric, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM numerics WINDOW w AS (ORDER BY f_numeric RANGE BETWEEN 1.1 PRECEDING AND 'NaN' FOLLOWING)"
  },
  {
    "comment": "window - Statement 154",
    "query": "create temp table datetimes( id int, f_time time, f_timetz timetz, f_interval interval, f_timestamptz timestamptz, f_timestamp timestamp )",
    "expected": "CREATE TEMPORARY TABLE datetimes (id INT, f_time TIME, f_timetz TIMETZ, f_interval INTERVAL, f_timestamptz TIMESTAMPTZ, f_timestamp TIMESTAMP)"
  },
  {
    "comment": "window - Statement 155",
    "query": "insert into datetimes values (0, '10:00', '10:00 BST', '-infinity', '-infinity', '-infinity'), (1, '11:00', '11:00 BST', '1 year', '2000-10-19 10:23:54+01', '2000-10-19 10:23:54'), (2, '12:00', '12:00 BST', '2 years', '2001-10-19 10:23:54+01', '2001-10-19 10:23:54'), (3, '13:00', '13:00 BST', '3 years', '2001-10-19 10:23:54+01', '2001-10-19 10:23:54'), (4, '14:00', '14:00 BST', '4 years', '2002-10-19 10:23:54+01', '2002-10-19 10:23:54'), (5, '15:00', '15:00 BST', '5 years', '2003-10-19 10:23:54+01', '2003-10-19 10:23:54'), (6, '15:00', '15:00 BST', '5 years', '2004-10-19 10:23:54+01', '2004-10-19 10:23:54'), (7, '17:00', '17:00 BST', '7 years', '2005-10-19 10:23:54+01', '2005-10-19 10:23:54'), (8, '18:00', '18:00 BST', '8 years', '2006-10-19 10:23:54+01', '2006-10-19 10:23:54'), (9, '19:00', '19:00 BST', '9 years', '2007-10-19 10:23:54+01', '2007-10-19 10:23:54'), (10, '20:00', '20:00 BST', '10 years', '2008-10-19 10:23:54+01', '2008-10-19 10:23:54'), (11, '21:00', '21:00 BST', 'infinity', 'infinity', 'infinity')",
    "expected": "INSERT INTO datetimes VALUES (0, '10:00', '10:00 BST', '-infinity', '-infinity', '-infinity'), (1, '11:00', '11:00 BST', '1 year', '2000-10-19 10:23:54+01', '2000-10-19 10:23:54'), (2, '12:00', '12:00 BST', '2 years', '2001-10-19 10:23:54+01', '2001-10-19 10:23:54'), (3, '13:00', '13:00 BST', '3 years', '2001-10-19 10:23:54+01', '2001-10-19 10:23:54'), (4, '14:00', '14:00 BST', '4 years', '2002-10-19 10:23:54+01', '2002-10-19 10:23:54'), (5, '15:00', '15:00 BST', '5 years', '2003-10-19 10:23:54+01', '2003-10-19 10:23:54'), (6, '15:00', '15:00 BST', '5 years', '2004-10-19 10:23:54+01', '2004-10-19 10:23:54'), (7, '17:00', '17:00 BST', '7 years', '2005-10-19 10:23:54+01', '2005-10-19 10:23:54'), (8, '18:00', '18:00 BST', '8 years', '2006-10-19 10:23:54+01', '2006-10-19 10:23:54'), (9, '19:00', '19:00 BST', '9 years', '2007-10-19 10:23:54+01', '2007-10-19 10:23:54'), (10, '20:00', '20:00 BST', '10 years', '2008-10-19 10:23:54+01', '2008-10-19 10:23:54'), (11, '21:00', '21:00 BST', 'infinity', 'infinity', 'infinity')"
  },
  {
    "comment": "window - Statement 156",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time range between '70 min'::interval preceding and '2 hours'::interval following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time RANGE BETWEEN CAST('70 min' AS INTERVAL) PRECEDING AND CAST('2 hours' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 157",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time desc range between '70 min' preceding and '2 hours' following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time DESC RANGE BETWEEN '70 min' PRECEDING AND '2 hours' FOLLOWING)"
  },
  {
    "comment": "window - Statement 158",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time desc range between '-70 min' preceding and '2 hours' following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time DESC RANGE BETWEEN '-70 min' PRECEDING AND '2 hours' FOLLOWING)"
  },
  {
    "comment": "window - Statement 159",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time range between 'infinity'::interval preceding and 'infinity'::interval following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 160",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time range between 'infinity'::interval preceding and 'infinity'::interval preceding)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) PRECEDING)"
  },
  {
    "comment": "window - Statement 161",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time range between 'infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 162",
    "query": "select id, f_time, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_time range between '-infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_time, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_time RANGE BETWEEN CAST('-infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 163",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz range between '70 min'::interval preceding and '2 hours'::interval following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz RANGE BETWEEN CAST('70 min' AS INTERVAL) PRECEDING AND CAST('2 hours' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 164",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz desc range between '70 min' preceding and '2 hours' following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz DESC RANGE BETWEEN '70 min' PRECEDING AND '2 hours' FOLLOWING)"
  },
  {
    "comment": "window - Statement 165",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz desc range between '70 min' preceding and '-2 hours' following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz DESC RANGE BETWEEN '70 min' PRECEDING AND '-2 hours' FOLLOWING)"
  },
  {
    "comment": "window - Statement 166",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz range between 'infinity'::interval preceding and 'infinity'::interval following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 167",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz range between 'infinity'::interval preceding and 'infinity'::interval preceding)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) PRECEDING)"
  },
  {
    "comment": "window - Statement 168",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz range between 'infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 169",
    "query": "select id, f_timetz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timetz range between 'infinity'::interval following and '-infinity'::interval following)",
    "expected": "SELECT id, f_timetz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timetz RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('-infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 170",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval range between '1 year'::interval preceding and '1 year'::interval following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 171",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval desc range between '1 year' preceding and '1 year' following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval DESC RANGE BETWEEN '1 year' PRECEDING AND '1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 172",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval desc range between '-1 year' preceding and '1 year' following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval DESC RANGE BETWEEN '-1 year' PRECEDING AND '1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 173",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval range between 'infinity'::interval preceding and 'infinity'::interval following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 174",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval range between 'infinity'::interval preceding and 'infinity'::interval preceding)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) PRECEDING)"
  },
  {
    "comment": "window - Statement 175",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval range between 'infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 176",
    "query": "select id, f_interval, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_interval range between '-infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_interval, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_interval RANGE BETWEEN CAST('-infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 177",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz range between '1 year'::interval preceding and '1 year'::interval following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 178",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz desc range between '1 year' preceding and '1 year' following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz DESC RANGE BETWEEN '1 year' PRECEDING AND '1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 179",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz desc range between '1 year' preceding and '-1 year' following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz DESC RANGE BETWEEN '1 year' PRECEDING AND '-1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 180",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz range between 'infinity'::interval preceding and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 181",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz range between 'infinity'::interval preceding and 'infinity'::interval preceding)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) PRECEDING)"
  },
  {
    "comment": "window - Statement 182",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz range between 'infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 183",
    "query": "select id, f_timestamptz, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamptz range between '-infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamptz, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamptz RANGE BETWEEN CAST('-infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 184",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp range between '1 year'::interval preceding and '1 year'::interval following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('1 year' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 185",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp desc range between '1 year' preceding and '1 year' following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp DESC RANGE BETWEEN '1 year' PRECEDING AND '1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 186",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp desc range between '-1 year' preceding and '1 year' following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp DESC RANGE BETWEEN '-1 year' PRECEDING AND '1 year' FOLLOWING)"
  },
  {
    "comment": "window - Statement 187",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp range between 'infinity'::interval preceding and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 188",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp range between 'infinity'::interval preceding and 'infinity'::interval preceding)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp RANGE BETWEEN CAST('infinity' AS INTERVAL) PRECEDING AND CAST('infinity' AS INTERVAL) PRECEDING)"
  },
  {
    "comment": "window - Statement 189",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp range between 'infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp RANGE BETWEEN CAST('infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 190",
    "query": "select id, f_timestamp, first_value(id) over w, last_value(id) over w from datetimes window w as (order by f_timestamp range between '-infinity'::interval following and 'infinity'::interval following)",
    "expected": "SELECT id, f_timestamp, FIRST_VALUE(id) OVER w, LAST_VALUE(id) OVER w FROM datetimes WINDOW w AS (ORDER BY f_timestamp RANGE BETWEEN CAST('-infinity' AS INTERVAL) FOLLOWING AND CAST('infinity' AS INTERVAL) FOLLOWING)"
  },
  {
    "comment": "window - Statement 191",
    "query": "select sum(salary) over (order by enroll_date, salary range between '1 year'::interval preceding and '2 years'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY enroll_date, salary RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('2 years' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 192",
    "query": "select sum(salary) over (range between '1 year'::interval preceding and '2 years'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('2 years' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 193",
    "query": "select sum(salary) over (order by depname range between '1 year'::interval preceding and '2 years'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT SUM(salary) OVER (ORDER BY depname RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('2 years' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 194",
    "query": "select max(enroll_date) over (order by enroll_date range between 1 preceding and 2 following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT MAX(enroll_date) OVER (ORDER BY enroll_date RANGE BETWEEN 1 PRECEDING AND 2 FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 195",
    "query": "select max(enroll_date) over (order by salary range between -1 preceding and 2 following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT MAX(enroll_date) OVER (ORDER BY salary RANGE BETWEEN -1 PRECEDING AND 2 FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 196",
    "query": "select max(enroll_date) over (order by salary range between 1 preceding and -2 following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT MAX(enroll_date) OVER (ORDER BY salary RANGE BETWEEN 1 PRECEDING AND -2 FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 197",
    "query": "select max(enroll_date) over (order by salary range between '1 year'::interval preceding and '2 years'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT MAX(enroll_date) OVER (ORDER BY salary RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('2 years' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 198",
    "query": "select max(enroll_date) over (order by enroll_date range between '1 year'::interval preceding and '-2 years'::interval following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT MAX(enroll_date) OVER (ORDER BY enroll_date RANGE BETWEEN CAST('1 year' AS INTERVAL) PRECEDING AND CAST('-2 years' AS INTERVAL) FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 199",
    "query": "SELECT sum(unique1) over (order by four groups between unbounded preceding and current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 200",
    "query": "SELECT sum(unique1) over (order by four groups between unbounded preceding and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 201",
    "query": "SELECT sum(unique1) over (order by four groups between current row and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 202",
    "query": "SELECT sum(unique1) over (order by four groups between 1 preceding and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 203",
    "query": "SELECT sum(unique1) over (order by four groups between 1 following and unbounded following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 204",
    "query": "SELECT sum(unique1) over (order by four groups between unbounded preceding and 2 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN UNBOUNDED PRECEDING AND 2 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 205",
    "query": "SELECT sum(unique1) over (order by four groups between 2 preceding and 1 preceding), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 2 PRECEDING AND 1 PRECEDING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 206",
    "query": "SELECT sum(unique1) over (order by four groups between 2 preceding and 1 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 2 PRECEDING AND 1 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 207",
    "query": "SELECT sum(unique1) over (order by four groups between 0 preceding and 0 following), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 0 PRECEDING AND 0 FOLLOWING), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 208",
    "query": "SELECT sum(unique1) over (order by four groups between 2 preceding and 1 following exclude current row), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 2 PRECEDING AND 1 FOLLOWING EXCLUDE CURRENT ROW), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 209",
    "query": "SELECT sum(unique1) over (order by four groups between 2 preceding and 1 following exclude group), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 2 PRECEDING AND 1 FOLLOWING EXCLUDE GROUP), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 210",
    "query": "SELECT sum(unique1) over (order by four groups between 2 preceding and 1 following exclude ties), unique1, four FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (ORDER BY four GROUPS BETWEEN 2 PRECEDING AND 1 FOLLOWING EXCLUDE TIES), unique1, four FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 211",
    "query": "SELECT sum(unique1) over (partition by ten order by four groups between 0 preceding and 0 following),unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY ten ORDER BY four GROUPS BETWEEN 0 PRECEDING AND 0 FOLLOWING), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 212",
    "query": "SELECT sum(unique1) over (partition by ten order by four groups between 0 preceding and 0 following exclude current row), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY ten ORDER BY four GROUPS BETWEEN 0 PRECEDING AND 0 FOLLOWING EXCLUDE CURRENT ROW), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 213",
    "query": "SELECT sum(unique1) over (partition by ten order by four groups between 0 preceding and 0 following exclude group), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY ten ORDER BY four GROUPS BETWEEN 0 PRECEDING AND 0 FOLLOWING EXCLUDE GROUP), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 214",
    "query": "SELECT sum(unique1) over (partition by ten order by four groups between 0 preceding and 0 following exclude ties), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10",
    "expected": "SELECT SUM(unique1) OVER (PARTITION BY ten ORDER BY four GROUPS BETWEEN 0 PRECEDING AND 0 FOLLOWING EXCLUDE TIES), unique1, four, ten FROM tenk1 WHERE unique1 \u003c 10"
  },
  {
    "comment": "window - Statement 215",
    "query": "select first_value(salary) over(order by enroll_date groups between 1 preceding and 1 following), lead(salary) over(order by enroll_date groups between 1 preceding and 1 following), nth_value(salary, 1) over(order by enroll_date groups between 1 preceding and 1 following), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING), LEAD(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING), NTH_VALUE(salary, 1) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 216",
    "query": "select last_value(salary) over(order by enroll_date groups between 1 preceding and 1 following), lag(salary) over(order by enroll_date groups between 1 preceding and 1 following), salary, enroll_date from empsalary",
    "expected": "SELECT LAST_VALUE(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING), LAG(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 217",
    "query": "select first_value(salary) over(order by enroll_date groups between 1 following and 3 following exclude current row), lead(salary) over(order by enroll_date groups between 1 following and 3 following exclude ties), nth_value(salary, 1) over(order by enroll_date groups between 1 following and 3 following exclude ties), salary, enroll_date from empsalary",
    "expected": "SELECT FIRST_VALUE(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 FOLLOWING AND 3 FOLLOWING EXCLUDE CURRENT ROW), LEAD(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 FOLLOWING AND 3 FOLLOWING EXCLUDE TIES), NTH_VALUE(salary, 1) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 FOLLOWING AND 3 FOLLOWING EXCLUDE TIES), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 218",
    "query": "select last_value(salary) over(order by enroll_date groups between 1 following and 3 following exclude group), lag(salary) over(order by enroll_date groups between 1 following and 3 following exclude group), salary, enroll_date from empsalary",
    "expected": "SELECT LAST_VALUE(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 FOLLOWING AND 3 FOLLOWING EXCLUDE GROUP), LAG(salary) OVER (ORDER BY enroll_date GROUPS BETWEEN 1 FOLLOWING AND 3 FOLLOWING EXCLUDE GROUP), salary, enroll_date FROM empsalary"
  },
  {
    "comment": "window - Statement 219",
    "query": "WITH cte (x) AS ( SELECT * FROM generate_series(1, 35, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x rows between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (SELECT * FROM generate_series(1, 35, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 220",
    "query": "WITH cte (x) AS ( SELECT * FROM generate_series(1, 35, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x range between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (SELECT * FROM generate_series(1, 35, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 221",
    "query": "WITH cte (x) AS ( SELECT * FROM generate_series(1, 35, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x groups between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (SELECT * FROM generate_series(1, 35, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 222",
    "query": "WITH cte (x) AS ( select 1 union all select 1 union all select 1 union all SELECT * FROM generate_series(5, 49, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x rows between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (((SELECT 1 UNION ALL SELECT 1) UNION ALL SELECT 1) UNION ALL SELECT * FROM generate_series(5, 49, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 223",
    "query": "WITH cte (x) AS ( select 1 union all select 1 union all select 1 union all SELECT * FROM generate_series(5, 49, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x range between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (((SELECT 1 UNION ALL SELECT 1) UNION ALL SELECT 1) UNION ALL SELECT * FROM generate_series(5, 49, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 224",
    "query": "WITH cte (x) AS ( select 1 union all select 1 union all select 1 union all SELECT * FROM generate_series(5, 49, 2) ) SELECT x, (sum(x) over w) FROM cte WINDOW w AS (ORDER BY x groups between 1 preceding and 1 following)",
    "expected": "WITH cte(x) AS (((SELECT 1 UNION ALL SELECT 1) UNION ALL SELECT 1) UNION ALL SELECT * FROM generate_series(5, 49, 2)) SELECT x, (SUM(x) OVER w) FROM cte WINDOW w AS (ORDER BY x GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING)"
  },
  {
    "comment": "window - Statement 225",
    "query": "SELECT count(*) OVER (PARTITION BY four) FROM (SELECT * FROM tenk1 UNION ALL SELECT * FROM tenk2)s LIMIT 0",
    "expected": "SELECT COUNT(*) OVER (PARTITION BY four) FROM (SELECT * FROM tenk1 UNION ALL SELECT * FROM tenk2) AS s LIMIT 0"
  },
  {
    "comment": "window - Statement 226",
    "query": "create temp table t1 (f1 int, f2 int8)",
    "expected": "CREATE TEMPORARY TABLE t1 (f1 INT, f2 BIGINT)"
  },
  {
    "comment": "window - Statement 227",
    "query": "insert into t1 values (1,1),(1,2),(2,2)",
    "expected": "INSERT INTO t1 VALUES (1, 1), (1, 2), (2, 2)"
  },
  {
    "comment": "window - Statement 228",
    "query": "select f1, sum(f1) over (partition by f1 range between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1 RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 229",
    "query": "explain (costs off) select f1, sum(f1) over (partition by f1 order by f2 range between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "EXPLAIN (COSTS false) SELECT f1, SUM(f1) OVER (PARTITION BY f1 ORDER BY f2 RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 230",
    "query": "select f1, sum(f1) over (partition by f1 order by f2 range between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1 ORDER BY f2 RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 231",
    "query": "select f1, sum(f1) over (partition by f1, f1 order by f2 range between 2 preceding and 1 preceding) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1, f1 ORDER BY f2 RANGE BETWEEN 2 PRECEDING AND 1 PRECEDING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 232",
    "query": "select f1, sum(f1) over (partition by f1, f2 order by f2 range between 1 following and 2 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1, f2 ORDER BY f2 RANGE BETWEEN 1 FOLLOWING AND 2 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 233",
    "query": "select f1, sum(f1) over (partition by f1 groups between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1 GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 234",
    "query": "explain (costs off) select f1, sum(f1) over (partition by f1 order by f2 groups between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "EXPLAIN (COSTS false) SELECT f1, SUM(f1) OVER (PARTITION BY f1 ORDER BY f2 GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 235",
    "query": "select f1, sum(f1) over (partition by f1 order by f2 groups between 1 preceding and 1 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1 ORDER BY f2 GROUPS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 236",
    "query": "select f1, sum(f1) over (partition by f1, f1 order by f2 groups between 2 preceding and 1 preceding) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1, f1 ORDER BY f2 GROUPS BETWEEN 2 PRECEDING AND 1 PRECEDING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 237",
    "query": "select f1, sum(f1) over (partition by f1, f2 order by f2 groups between 1 following and 2 following) from t1 where f1 = f2",
    "expected": "SELECT f1, SUM(f1) OVER (PARTITION BY f1, f2 ORDER BY f2 GROUPS BETWEEN 1 FOLLOWING AND 2 FOLLOWING) FROM t1 WHERE f1 = f2"
  },
  {
    "comment": "window - Statement 238",
    "query": "SELECT rank() OVER (ORDER BY length('abc'))",
    "expected": "SELECT RANK() OVER (ORDER BY length('abc'))"
  },
  {
    "comment": "window - Statement 239",
    "query": "SELECT rank() OVER (ORDER BY rank() OVER (ORDER BY random()))",
    "expected": "SELECT RANK() OVER (ORDER BY RANK() OVER (ORDER BY random()))"
  },
  {
    "comment": "window - Statement 240",
    "query": "SELECT * FROM empsalary WHERE row_number() OVER (ORDER BY salary) \u003c 10",
    "expected": "SELECT * FROM empsalary WHERE ROW_NUMBER() OVER (ORDER BY salary) \u003c 10"
  },
  {
    "comment": "window - Statement 241",
    "query": "SELECT * FROM empsalary INNER JOIN tenk1 ON row_number() OVER (ORDER BY salary) \u003c 10",
    "expected": "SELECT * FROM empsalary INNER JOIN tenk1 ON ROW_NUMBER() OVER (ORDER BY salary) \u003c 10"
  },
  {
    "comment": "window - Statement 242",
    "query": "SELECT rank() OVER (ORDER BY 1), count(*) FROM empsalary GROUP BY 1",
    "expected": "SELECT RANK() OVER (ORDER BY 1), COUNT(*) FROM empsalary GROUP BY 1"
  },
  {
    "comment": "window - Statement 243",
    "query": "SELECT * FROM rank() OVER (ORDER BY random())",
    "error": "parse error at position 32: syntax error"
  },
  {
    "comment": "window - Statement 244",
    "query": "DELETE FROM empsalary WHERE (rank() OVER (ORDER BY random())) \u003e 10",
    "expected": "DELETE FROM empsalary WHERE (RANK() OVER (ORDER BY random())) \u003e 10"
  },
  {
    "comment": "window - Statement 245",
    "query": "DELETE FROM empsalary RETURNING rank() OVER (ORDER BY random())",
    "expected": "DELETE FROM empsalary RETURNING RANK() OVER (ORDER BY random())"
  },
  {
    "comment": "window - Statement 246",
    "query": "SELECT count(*) OVER w FROM tenk1 WINDOW w AS (ORDER BY unique1), w AS (ORDER BY unique1)",
    "expected": "SELECT COUNT(*) OVER w FROM tenk1 WINDOW w AS (ORDER BY unique1), w AS (ORDER BY unique1)"
  },
  {
    "comment": "window - Statement 247",
    "query": "SELECT rank() OVER (PARTITION BY four, ORDER BY ten) FROM tenk1",
    "error": "parse error at position 44: syntax error"
  },
  {
    "comment": "window - Statement 248",
    "query": "SELECT count() OVER () FROM tenk1",
    "expected": "SELECT COUNT() OVER () FROM tenk1"
  },
  {
    "comment": "window - Statement 249",
    "query": "SELECT generate_series(1, 100) OVER () FROM empsalary"
  },
  {
    "comment": "window - Statement 250",
    "query": "SELECT ntile(0) OVER (ORDER BY ten), ten, four FROM tenk1",
    "expected": "SELECT NTILE(0) OVER (ORDER BY ten), ten, four FROM tenk1"
  },
  {
    "comment": "window - Statement 251",
    "query": "SELECT nth_value(four, 0) OVER (ORDER BY ten), ten, four FROM tenk1",
    "expected": "SELECT NTH_VALUE(four, 0) OVER (ORDER BY ten), ten, four FROM tenk1"
  },
  {
    "comment": "window - Statement 252",
    "query": "SELECT sum(salary), row_number() OVER (ORDER BY depname), sum( sum(salary) FILTER (WHERE enroll_date \u003e '2007-01-01') ) FILTER (WHERE depname \u003c\u003e 'sales') OVER (ORDER BY depname DESC) AS \"filtered_sum\", depname FROM empsalary GROUP BY depname",
    "expected": "SELECT SUM(salary), ROW_NUMBER() OVER (ORDER BY depname), SUM(SUM(salary) FILTER (WHERE enroll_date \u003e '2007-01-01')) FILTER (WHERE depname \u003c\u003e 'sales') OVER (ORDER BY depname DESC) AS filtered_sum, depname FROM empsalary GROUP BY depname"
  },
  {
    "comment": "window - Statement 253",
    "query": "EXPLAIN (COSTS OFF) SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY enroll_date) rn, rank() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) rnk, dense_rank() OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) drnk, ntile(10) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) nt, percent_rank() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) pr, cume_dist() OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) cd FROM empsalary",
    "expected": "EXPLAIN (COSTS false) SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date) AS rn, RANK() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS rnk, DENSE_RANK() OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) AS drnk, NTILE(10) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS nt, PERCENT_RANK() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS pr, CUME_DIST() OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS cd FROM empsalary"
  },
  {
    "comment": "window - Statement 254",
    "query": "EXPLAIN (COSTS OFF, VERBOSE) SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY enroll_date) rn, rank() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) rnk, count(*) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) cnt FROM empsalary",
    "expected": "EXPLAIN (COSTS false, VERBOSE true) SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date) AS rn, RANK() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS rnk, COUNT(*) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) AS cnt FROM empsalary"
  },
  {
    "comment": "window - Statement 255",
    "query": "SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY enroll_date) rn, rank() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) rnk, count(*) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) cnt FROM empsalary",
    "expected": "SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date) AS rn, RANK() OVER (PARTITION BY depname ORDER BY enroll_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS rnk, COUNT(*) OVER (PARTITION BY depname ORDER BY enroll_date RANGE BETWEEN CURRENT ROW AND CURRENT ROW) AS cnt FROM empsalary"
  },
  {
    "comment": "window - Statement 256",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT depname, sum(salary) OVER (PARTITION BY depname) depsalary, min(salary) OVER (PARTITION BY depname || 'A', depname) depminsalary FROM empsalary) emp WHERE depname = 'sales'",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT depname, SUM(salary) OVER (PARTITION BY depname) AS depsalary, MIN(salary) OVER (PARTITION BY depname || 'A', depname) AS depminsalary FROM empsalary) AS emp WHERE depname = 'sales'"
  },
  {
    "comment": "window - Statement 257",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT depname, sum(salary) OVER (PARTITION BY enroll_date) enroll_salary, min(salary) OVER (PARTITION BY depname) depminsalary FROM empsalary) emp WHERE depname = 'sales'",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT depname, SUM(salary) OVER (PARTITION BY enroll_date) AS enroll_salary, MIN(salary) OVER (PARTITION BY depname) AS depminsalary FROM empsalary) AS emp WHERE depname = 'sales'"
  },
  {
    "comment": "window - Statement 258",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, row_number() OVER (ORDER BY empno) rn FROM empsalary) emp WHERE rn \u003c 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, ROW_NUMBER() OVER (ORDER BY empno) AS rn FROM empsalary) AS emp WHERE rn \u003c 3"
  },
  {
    "comment": "window - Statement 259",
    "query": "SELECT * FROM (SELECT empno, row_number() OVER (ORDER BY empno) rn FROM empsalary) emp WHERE rn \u003c 3",
    "expected": "SELECT * FROM (SELECT empno, ROW_NUMBER() OVER (ORDER BY empno) AS rn FROM empsalary) AS emp WHERE rn \u003c 3"
  },
  {
    "comment": "window - Statement 260",
    "query": "SELECT * FROM (SELECT empno, row_number() OVER (ORDER BY empno) rn FROM empsalary) emp WHERE 3 \u003e rn",
    "expected": "SELECT * FROM (SELECT empno, ROW_NUMBER() OVER (ORDER BY empno) AS rn FROM empsalary) AS emp WHERE 3 \u003e rn"
  },
  {
    "comment": "window - Statement 261",
    "query": "SELECT * FROM (SELECT empno, row_number() OVER (ORDER BY empno) rn FROM empsalary) emp WHERE 2 \u003e= rn",
    "expected": "SELECT * FROM (SELECT empno, ROW_NUMBER() OVER (ORDER BY empno) AS rn FROM empsalary) AS emp WHERE 2 \u003e= rn"
  },
  {
    "comment": "window - Statement 262",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, rank() OVER (ORDER BY salary DESC) r FROM empsalary) emp WHERE r \u003c= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, RANK() OVER (ORDER BY salary DESC) AS r FROM empsalary) AS emp WHERE r \u003c= 3"
  },
  {
    "comment": "window - Statement 263",
    "query": "SELECT * FROM (SELECT empno, salary, rank() OVER (ORDER BY salary DESC) r FROM empsalary) emp WHERE r \u003c= 3",
    "expected": "SELECT * FROM (SELECT empno, salary, RANK() OVER (ORDER BY salary DESC) AS r FROM empsalary) AS emp WHERE r \u003c= 3"
  },
  {
    "comment": "window - Statement 264",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, dense_rank() OVER (ORDER BY salary DESC) dr FROM empsalary) emp WHERE dr = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, DENSE_RANK() OVER (ORDER BY salary DESC) AS dr FROM empsalary) AS emp WHERE dr = 1"
  },
  {
    "comment": "window - Statement 265",
    "query": "SELECT * FROM (SELECT empno, salary, dense_rank() OVER (ORDER BY salary DESC) dr FROM empsalary) emp WHERE dr = 1",
    "expected": "SELECT * FROM (SELECT empno, salary, DENSE_RANK() OVER (ORDER BY salary DESC) AS dr FROM empsalary) AS emp WHERE dr = 1"
  },
  {
    "comment": "window - Statement 266",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 267",
    "query": "SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 268",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(empno) OVER (ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(empno) OVER (ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 269",
    "query": "SELECT * FROM (SELECT empno, salary, count(empno) OVER (ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "SELECT * FROM (SELECT empno, salary, COUNT(empno) OVER (ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 270",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) c FROM empsalary) emp WHERE c \u003e= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS c FROM empsalary) AS emp WHERE c \u003e= 3"
  },
  {
    "comment": "window - Statement 271",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER () c FROM empsalary) emp WHERE 11 \u003c= c",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER () AS c FROM empsalary) AS emp WHERE 11 \u003c= c"
  },
  {
    "comment": "window - Statement 272",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary DESC) c, dense_rank() OVER (ORDER BY salary DESC) dr FROM empsalary) emp WHERE dr = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary DESC) AS c, DENSE_RANK() OVER (ORDER BY salary DESC) AS dr FROM empsalary) AS emp WHERE dr = 1"
  },
  {
    "comment": "window - Statement 273",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY empno) rn FROM empsalary) emp WHERE rn \u003c 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY empno) AS rn FROM empsalary) AS emp WHERE rn \u003c 3"
  },
  {
    "comment": "window - Statement 274",
    "query": "SELECT * FROM (SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY empno) rn FROM empsalary) emp WHERE rn \u003c 3",
    "expected": "SELECT * FROM (SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY empno) AS rn FROM empsalary) AS emp WHERE rn \u003c 3"
  },
  {
    "comment": "window - Statement 275",
    "query": "EXPLAIN (COSTS OFF) SELECT empno, depname FROM (SELECT empno, depname, row_number() OVER (PARTITION BY depname ORDER BY empno) rn FROM empsalary) emp WHERE rn \u003c 3",
    "expected": "EXPLAIN (COSTS false) SELECT empno, depname FROM (SELECT empno, depname, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY empno) AS rn FROM empsalary) AS emp WHERE rn \u003c 3"
  },
  {
    "comment": "window - Statement 276",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, depname, salary, count(empno) OVER (PARTITION BY depname ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, depname, salary, COUNT(empno) OVER (PARTITION BY depname ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 277",
    "query": "SELECT * FROM (SELECT empno, depname, salary, count(empno) OVER (PARTITION BY depname ORDER BY salary DESC) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "SELECT * FROM (SELECT empno, depname, salary, COUNT(empno) OVER (PARTITION BY depname ORDER BY salary DESC) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 278",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, depname, salary, count(empno) OVER () c FROM empsalary) emp WHERE c = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, depname, salary, COUNT(empno) OVER () AS c FROM empsalary) AS emp WHERE c = 1"
  },
  {
    "comment": "window - Statement 279",
    "query": "SELECT * FROM (SELECT row_number() OVER (PARTITION BY salary) AS rn, lead(depname) OVER (PARTITION BY salary) || ' Department' AS n_dep FROM empsalary) emp WHERE rn \u003c 1",
    "expected": "SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY salary) AS rn, LEAD(depname) OVER (PARTITION BY salary) || ' Department' AS n_dep FROM empsalary) AS emp WHERE rn \u003c 1"
  },
  {
    "comment": "window - Statement 280",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT *, count(salary) OVER (PARTITION BY depname || '') c1, row_number() OVER (PARTITION BY depname) rn, count(*) OVER (PARTITION BY depname) c2, count(*) OVER (PARTITION BY '' || depname) c3, ntile(2) OVER (PARTITION BY depname) nt FROM empsalary ) e WHERE rn \u003c= 1 AND c1 \u003c= 3 AND nt \u003c 2",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT *, COUNT(salary) OVER (PARTITION BY depname || '') AS c1, ROW_NUMBER() OVER (PARTITION BY depname) AS rn, COUNT(*) OVER (PARTITION BY depname) AS c2, COUNT(*) OVER (PARTITION BY '' || depname) AS c3, NTILE(2) OVER (PARTITION BY depname) AS nt FROM empsalary) AS e WHERE rn \u003c= 1 AND c1 \u003c= 3 AND nt \u003c 2"
  },
  {
    "comment": "window - Statement 281",
    "query": "SELECT * FROM (SELECT *, count(salary) OVER (PARTITION BY depname || '') c1, row_number() OVER (PARTITION BY depname) rn, count(*) OVER (PARTITION BY depname) c2, count(*) OVER (PARTITION BY '' || depname) c3, ntile(2) OVER (PARTITION BY depname) nt FROM empsalary ) e WHERE rn \u003c= 1 AND c1 \u003c= 3 AND nt \u003c 2",
    "expected": "SELECT * FROM (SELECT *, COUNT(salary) OVER (PARTITION BY depname || '') AS c1, ROW_NUMBER() OVER (PARTITION BY depname) AS rn, COUNT(*) OVER (PARTITION BY depname) AS c2, COUNT(*) OVER (PARTITION BY '' || depname) AS c3, NTILE(2) OVER (PARTITION BY depname) AS nt FROM empsalary) AS e WHERE rn \u003c= 1 AND c1 \u003c= 3 AND nt \u003c 2"
  },
  {
    "comment": "window - Statement 282",
    "query": "EXPLAIN (COSTS OFF) SELECT 1 FROM (SELECT ntile(e2.salary) OVER (PARTITION BY e1.depname) AS c FROM empsalary e1 LEFT JOIN empsalary e2 ON TRUE WHERE e1.empno = e2.empno) s WHERE s.c = 1",
    "expected": "EXPLAIN (COSTS false) SELECT 1 FROM (SELECT NTILE(e2.salary) OVER (PARTITION BY e1.depname) AS c FROM empsalary AS e1 LEFT OUTER JOIN empsalary AS e2 ON TRUE WHERE e1.empno = e2.empno) AS s WHERE s.c = 1"
  },
  {
    "comment": "window - Statement 283",
    "query": "EXPLAIN (COSTS OFF) SELECT 1 FROM (SELECT ntile(s1.x) OVER () AS c FROM (SELECT (SELECT 1) AS x) AS s1) s WHERE s.c = 1",
    "expected": "EXPLAIN (COSTS false) SELECT 1 FROM (SELECT NTILE(s1.x) OVER () AS c FROM (SELECT (SELECT 1) AS x) AS s1) AS s WHERE s.c = 1"
  },
  {
    "comment": "window - Statement 284",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) c FROM empsalary) emp WHERE c \u003c= 3",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS c FROM empsalary) AS emp WHERE c \u003c= 3"
  },
  {
    "comment": "window - Statement 285",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(*) OVER (ORDER BY salary) c FROM empsalary) emp WHERE 3 \u003c= c",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(*) OVER (ORDER BY salary) AS c FROM empsalary) AS emp WHERE 3 \u003c= c"
  },
  {
    "comment": "window - Statement 286",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count(random()) OVER (ORDER BY empno DESC) c FROM empsalary) emp WHERE c = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT(random()) OVER (ORDER BY empno DESC) AS c FROM empsalary) AS emp WHERE c = 1"
  },
  {
    "comment": "window - Statement 287",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT empno, salary, count((SELECT 1)) OVER (ORDER BY empno DESC) c FROM empsalary) emp WHERE c = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT empno, salary, COUNT((SELECT 1)) OVER (ORDER BY empno DESC) AS c FROM empsalary) AS emp WHERE c = 1"
  },
  {
    "comment": "window - Statement 288",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT depname, sum(salary) OVER (PARTITION BY depname order by empno) depsalary, min(salary) OVER (PARTITION BY depname, empno order by enroll_date) depminsalary FROM empsalary) emp WHERE depname = 'sales'",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT depname, SUM(salary) OVER (PARTITION BY depname ORDER BY empno) AS depsalary, MIN(salary) OVER (PARTITION BY depname, empno ORDER BY enroll_date) AS depminsalary FROM empsalary) AS emp WHERE depname = 'sales'"
  },
  {
    "comment": "window - Statement 289",
    "query": "EXPLAIN (COSTS OFF) SELECT empno, enroll_date, depname, sum(salary) OVER (PARTITION BY depname order by empno) depsalary, min(salary) OVER (PARTITION BY depname order by enroll_date) depminsalary FROM empsalary ORDER BY depname, empno",
    "expected": "EXPLAIN (COSTS false) SELECT empno, enroll_date, depname, SUM(salary) OVER (PARTITION BY depname ORDER BY empno) AS depsalary, MIN(salary) OVER (PARTITION BY depname ORDER BY enroll_date) AS depminsalary FROM empsalary ORDER BY depname, empno"
  },
  {
    "comment": "window - Statement 290",
    "query": "EXPLAIN (COSTS OFF) SELECT empno, enroll_date, depname, sum(salary) OVER (PARTITION BY depname order by empno) depsalary, min(salary) OVER (PARTITION BY depname order by enroll_date) depminsalary FROM empsalary ORDER BY depname, enroll_date",
    "expected": "EXPLAIN (COSTS false) SELECT empno, enroll_date, depname, SUM(salary) OVER (PARTITION BY depname ORDER BY empno) AS depsalary, MIN(salary) OVER (PARTITION BY depname ORDER BY enroll_date) AS depminsalary FROM empsalary ORDER BY depname, enroll_date"
  },
  {
    "comment": "window - Statement 291",
    "query": "SET enable_hashagg TO off",
    "expected": "SET enable_hashagg = off"
  },
  {
    "comment": "window - Statement 292",
    "query": "EXPLAIN (COSTS OFF) SELECT DISTINCT empno, enroll_date, depname, sum(salary) OVER (PARTITION BY depname order by empno) depsalary, min(salary) OVER (PARTITION BY depname order by enroll_date) depminsalary FROM empsalary ORDER BY depname, enroll_date",
    "expected": "EXPLAIN (COSTS false) SELECT DISTINCT empno, enroll_date, depname, SUM(salary) OVER (PARTITION BY depname ORDER BY empno) AS depsalary, MIN(salary) OVER (PARTITION BY depname ORDER BY enroll_date) AS depminsalary FROM empsalary ORDER BY depname, enroll_date"
  },
  {
    "comment": "window - Statement 293",
    "query": "EXPLAIN (COSTS OFF) SELECT DISTINCT empno, enroll_date, depname, sum(salary) OVER (PARTITION BY depname order by empno) depsalary, min(salary) OVER (PARTITION BY depname order by enroll_date) depminsalary FROM empsalary ORDER BY depname, empno",
    "expected": "EXPLAIN (COSTS false) SELECT DISTINCT empno, enroll_date, depname, SUM(salary) OVER (PARTITION BY depname ORDER BY empno) AS depsalary, MIN(salary) OVER (PARTITION BY depname ORDER BY enroll_date) AS depminsalary FROM empsalary ORDER BY depname, empno"
  },
  {
    "comment": "window - Statement 294",
    "query": "RESET enable_hashagg"
  },
  {
    "comment": "window - Statement 295",
    "query": "EXPLAIN (COSTS OFF) SELECT lead(1) OVER (PARTITION BY depname ORDER BY salary, enroll_date), lag(1) OVER (PARTITION BY depname ORDER BY salary,enroll_date,empno) FROM empsalary",
    "expected": "EXPLAIN (COSTS false) SELECT LEAD(1) OVER (PARTITION BY depname ORDER BY salary, enroll_date), LAG(1) OVER (PARTITION BY depname ORDER BY salary, enroll_date, empno) FROM empsalary"
  },
  {
    "comment": "window - Statement 296",
    "query": "EXPLAIN (COSTS OFF) SELECT * FROM (SELECT depname, empno, salary, enroll_date, row_number() OVER (PARTITION BY depname ORDER BY enroll_date) AS first_emp, row_number() OVER (PARTITION BY depname ORDER BY enroll_date DESC) AS last_emp FROM empsalary) emp WHERE first_emp = 1 OR last_emp = 1",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM (SELECT depname, empno, salary, enroll_date, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date) AS first_emp, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date DESC) AS last_emp FROM empsalary) AS emp WHERE first_emp = 1 OR last_emp = 1"
  },
  {
    "comment": "window - Statement 297",
    "query": "SELECT * FROM (SELECT depname, empno, salary, enroll_date, row_number() OVER (PARTITION BY depname ORDER BY enroll_date) AS first_emp, row_number() OVER (PARTITION BY depname ORDER BY enroll_date DESC) AS last_emp FROM empsalary) emp WHERE first_emp = 1 OR last_emp = 1",
    "expected": "SELECT * FROM (SELECT depname, empno, salary, enroll_date, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date) AS first_emp, ROW_NUMBER() OVER (PARTITION BY depname ORDER BY enroll_date DESC) AS last_emp FROM empsalary) AS emp WHERE first_emp = 1 OR last_emp = 1"
  },
  {
    "comment": "window - Statement 298",
    "query": "DROP TABLE empsalary"
  },
  {
    "comment": "window - Statement 299",
    "query": "CREATE FUNCTION nth_value_def(val anyelement, n integer = 1) RETURNS anyelement LANGUAGE internal WINDOW IMMUTABLE STRICT AS 'window_nth_value'",
    "expected": "CREATE FUNCTION nth_value_def (val anyelement, n INT DEFAULT 1) RETURNS anyelement LANGUAGE internal WINDOW IMMUTABLE STRICT AS $$window_nth_value$$"
  },
  {
    "comment": "window - Statement 300",
    "query": "SELECT nth_value_def(n := 2, val := ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) s",
    "expected": "SELECT nth_value_def(n =\u003e 2, val =\u003e ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) AS s"
  },
  {
    "comment": "window - Statement 301",
    "query": "SELECT nth_value_def(ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) s",
    "expected": "SELECT nth_value_def(ten) OVER (PARTITION BY four), ten, four FROM (SELECT * FROM tenk1 WHERE unique2 \u003c 10 ORDER BY four, ten) AS s"
  },
  {
    "comment": "window - Statement 302",
    "query": "CREATE FUNCTION logging_sfunc_nonstrict(text, anyelement) RETURNS text AS $$ SELECT COALESCE($1, '') || '*' || quote_nullable($2) $$ LANGUAGE SQL IMMUTABLE;  CREATE FUNCTION logging_msfunc_nonstrict(text, anyelement) RETURNS text AS $$ SELECT COALESCE($1, '') || '+' || quote_nullable($2) $$ LANGUAGE SQL IMMUTABLE;  CREATE FUNCTION logging_minvfunc_nonstrict(text, anyelement) RETURNS text AS $$ SELECT $1 || '-' || quote_nullable($2) $$ LANGUAGE SQL IMMUTABLE;  CREATE AGGREGATE logging_agg_nonstrict (anyelement) ( stype = text, sfunc = logging_sfunc_nonstrict, mstype = text, msfunc = logging_msfunc_nonstrict, minvfunc = logging_minvfunc_nonstrict );  CREATE AGGREGATE logging_agg_nonstrict_initcond (anyelement) ( stype = text, sfunc = logging_sfunc_nonstrict, mstype = text, msfunc = logging_msfunc_nonstrict, minvfunc = logging_minvfunc_nonstrict, initcond = 'I', minitcond = 'MI' );  CREATE FUNCTION logging_sfunc_strict(text, anyelement) RETURNS text AS $$ SELECT $1 || '*' || quote_nullable($2) $$ LANGUAGE SQL STRICT IMMUTABLE;  CREATE FUNCTION logging_msfunc_strict(text, anyelement) RETURNS text AS $$ SELECT $1 || '+' || quote_nullable($2) $$ LANGUAGE SQL STRICT IMMUTABLE;  CREATE FUNCTION logging_minvfunc_strict(text, anyelement) RETURNS text AS $$ SELECT $1 || '-' || quote_nullable($2) $$ LANGUAGE SQL STRICT IMMUTABLE;  CREATE AGGREGATE logging_agg_strict (text) ( stype = text, sfunc = logging_sfunc_strict, mstype = text, msfunc = logging_msfunc_strict, minvfunc = logging_minvfunc_strict );  CREATE AGGREGATE logging_agg_strict_initcond (anyelement) ( stype = text, sfunc = logging_sfunc_strict, mstype = text, msfunc = logging_msfunc_strict, minvfunc = logging_minvfunc_strict, initcond = 'I', minitcond = 'MI' );   SELECT p::text || ',' || i::text || ':' || COALESCE(v::text, 'NULL') AS row, logging_agg_nonstrict(v) over wnd as nstrict, logging_agg_nonstrict_initcond(v) over wnd as nstrict_init, logging_agg_strict(v::text) over wnd as strict, logging_agg_strict_initcond(v) over wnd as strict_init FROM (VALUES (1, 1, NULL), (1, 2, 'a'), (1, 3, 'b'), (1, 4, NULL), (1, 5, NULL), (1, 6, 'c'), (2, 1, NULL), (2, 2, 'x'), (3, 1, 'z') ) AS t(p, i, v) WINDOW wnd AS (PARTITION BY P ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY p, i;   SELECT p::text || ',' || i::text || ':' || CASE WHEN f THEN COALESCE(v::text, 'NULL') ELSE '-' END as row, logging_agg_nonstrict(v) filter(where f) over wnd as nstrict_filt, logging_agg_nonstrict_initcond(v) filter(where f) over wnd as nstrict_init_filt, logging_agg_strict(v::text) filter(where f) over wnd as strict_filt, logging_agg_strict_initcond(v) filter(where f) over wnd as strict_init_filt FROM (VALUES (1, 1, true,  NULL), (1, 2, false, 'a'), (1, 3, true,  'b'), (1, 4, false, NULL), (1, 5, false, NULL), (1, 6, false, 'c'), (2, 1, false, NULL), (2, 2, true,  'x'), (3, 1, true,  'z') ) AS t(p, i, f, v) WINDOW wnd AS (PARTITION BY p ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY p, i;   SELECT i::text || ':' || COALESCE(v::text, 'NULL') as row, logging_agg_strict(v::text) over wnd as inverse, logging_agg_strict(v::text || CASE WHEN random() \u003c 0 then '?' ELSE '' END) over wnd as noinverse FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c') ) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY i;  SELECT i::text || ':' || COALESCE(v::text, 'NULL') as row, logging_agg_strict(v::text) filter(where true) over wnd as inverse, logging_agg_strict(v::text) filter(where random() \u003e= 0) over wnd as noinverse FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c') ) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY i;   SELECT logging_agg_strict(v::text) OVER wnd FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c') ) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW) ORDER BY i;       CREATE FUNCTION sum_int_randrestart_minvfunc(int4, int4) RETURNS int4 AS $$ SELECT CASE WHEN random() \u003c 0.2 THEN NULL ELSE $1 - $2 END $$ LANGUAGE SQL STRICT;  CREATE AGGREGATE sum_int_randomrestart (int4) ( stype = int4, sfunc = int4pl, mstype = int4, msfunc = int4pl, minvfunc = sum_int_randrestart_minvfunc );  WITH vs AS ( SELECT i, (random() * 100)::int4 AS v FROM generate_series(1, 100) AS i ), sum_following AS ( SELECT i, SUM(v) OVER (ORDER BY i DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS s FROM vs ) SELECT DISTINCT sum_following.s = sum_int_randomrestart(v) OVER fwd AS eq1, -sum_following.s = sum_int_randomrestart(-v) OVER fwd AS eq2, 100*3+(vs.i-1)*3 = length(logging_agg_nonstrict(''::text) OVER fwd) AS eq3 FROM vs JOIN sum_following ON sum_following.i = vs.i WINDOW fwd AS ( ORDER BY vs.i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING );       SELECT i,AVG(v::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,AVG(v::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,AVG(v::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,AVG(v::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v);  SELECT i,AVG(v::interval) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,'1 sec'),(2,'2 sec'),(3,NULL),(4,NULL)) t(i,v);   SELECT  x ,avg(x) OVER(ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING ) as curr_next_avg ,avg(x) OVER(ROWS BETWEEN 1 PRECEDING AND CURRENT ROW ) as prev_curr_avg ,sum(x) OVER(ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING ) as curr_next_sum ,sum(x) OVER(ROWS BETWEEN 1 PRECEDING AND CURRENT ROW ) as prev_curr_sum FROM (VALUES (NULL::interval), ('infinity'::interval), ('-2147483648 days -2147483648 months -9223372036854775807 usecs'), ('-infinity'::interval), ('2147483647 days 2147483647 months 9223372036854775806 usecs'), ('infinity'::interval), ('6 days'::interval), ('7 days'::interval), (NULL::interval), ('-infinity'::interval)) v(x);   SELECT x, avg(x) OVER(ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM (VALUES (NULL::interval), ('3 days'::interval), ('infinity'::timestamptz - now()), ('6 days'::interval), ('-infinity'::interval)) v(x);   SELECT x, sum(x) OVER(ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM (VALUES (NULL::interval), ('3 days'::interval), ('infinity'::timestamptz - now()), ('6 days'::interval), ('-infinity'::interval)) v(x);  SELECT i,SUM(v::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::money) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,'1.10'),(2,'2.20'),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::interval) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,'1 sec'),(2,'2 sec'),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v);  SELECT SUM(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n);  SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT VAR_POP(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_POP(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_POP(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_POP(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_SAMP(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_SAMP(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_SAMP(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VAR_SAMP(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VARIANCE(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VARIANCE(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VARIANCE(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT VARIANCE(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT STDDEV_POP(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_POP(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_POP(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_POP(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_SAMP(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_SAMP(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_SAMP(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV_SAMP(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n);  SELECT STDDEV(n::bigint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT STDDEV(n::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT STDDEV(n::smallint) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);  SELECT STDDEV(n::numeric) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n);   SELECT i,SUM(v::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::int) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v);  SELECT i,SUM(v::int) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v);   SELECT a, b, SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) FROM (VALUES(1,1::numeric),(2,2),(3,'NaN'),(4,3),(5,4)) t(a,b);      SELECT to_char(SUM(n::float8) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING),'999999999999999999999D9') FROM (VALUES(1,1e20),(2,1)) n(i,n);  SELECT i, b, bool_and(b) OVER w, bool_or(b) OVER w FROM (VALUES (1,true), (2,true), (3,false), (4,false), (5,true)) v(i,b) WINDOW w AS (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING);         EXPLAIN (COSTS OFF) SELECT COUNT(*) OVER (ORDER BY t1.unique1) FROM tenk1 t1 INNER JOIN tenk1 t2 ON t1.unique1 = t2.tenthous LIMIT 1;     EXPLAIN (COSTS OFF) SELECT COUNT(*) OVER () FROM tenk1 t1 INNER JOIN tenk1 t2 ON t1.unique1 = t2.tenthous WHERE t2.two = 1 LIMIT 1;    EXPLAIN (COSTS OFF) SELECT COUNT(*) OVER (ORDER BY t1.unique1 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM tenk1 t1 INNER JOIN tenk1 t2 ON t1.unique1 = t2.tenthous LIMIT 1;    EXPLAIN (COSTS OFF) SELECT COUNT(*) OVER (ORDER BY t1.unique1 ROWS BETWEEN UNBOUNDED PRECEDING AND 10000 FOLLOWING) FROM tenk1 t1 INNER JOIN tenk1 t2 ON t1.unique1 = t2.tenthous LIMIT 1;      SELECT array_agg(i) OVER w FROM generate_series(1,5) i WINDOW w AS (ORDER BY i ROWS BETWEEN (('foo' \u003c 'foobar')::integer) PRECEDING AND CURRENT ROW);   CREATE FUNCTION pg_temp.f(group_size BIGINT) RETURNS SETOF integer[] AS $$ SELECT array_agg(s) OVER w FROM generate_series(1,5) s WINDOW w AS (ORDER BY s ROWS BETWEEN CURRENT ROW AND GROUP_SIZE FOLLOWING) $$ LANGUAGE SQL STABLE",
    "expected": "CREATE FUNCTION logging_sfunc_nonstrict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT COALESCE($1, '') || '*' || quote_nullable($2) $$ LANGUAGE sql IMMUTABLE; CREATE FUNCTION logging_msfunc_nonstrict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT COALESCE($1, '') || '+' || quote_nullable($2) $$ LANGUAGE sql IMMUTABLE; CREATE FUNCTION logging_minvfunc_nonstrict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT $1 || '-' || quote_nullable($2) $$ LANGUAGE sql IMMUTABLE; CREATE AGGREGATE logging_agg_nonstrict (anyelement) (stype = TEXT, sfunc = logging_sfunc_nonstrict, mstype = TEXT, msfunc = logging_msfunc_nonstrict, minvfunc = logging_minvfunc_nonstrict); CREATE AGGREGATE logging_agg_nonstrict_initcond (anyelement) (stype = TEXT, sfunc = logging_sfunc_nonstrict, mstype = TEXT, msfunc = logging_msfunc_nonstrict, minvfunc = logging_minvfunc_nonstrict, initcond = 'I', minitcond = 'MI'); CREATE FUNCTION logging_sfunc_strict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT $1 || '*' || quote_nullable($2) $$ LANGUAGE sql STRICT IMMUTABLE; CREATE FUNCTION logging_msfunc_strict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT $1 || '+' || quote_nullable($2) $$ LANGUAGE sql STRICT IMMUTABLE; CREATE FUNCTION logging_minvfunc_strict (TEXT, anyelement) RETURNS TEXT AS $$ SELECT $1 || '-' || quote_nullable($2) $$ LANGUAGE sql STRICT IMMUTABLE; CREATE AGGREGATE logging_agg_strict (TEXT) (stype = TEXT, sfunc = logging_sfunc_strict, mstype = TEXT, msfunc = logging_msfunc_strict, minvfunc = logging_minvfunc_strict); CREATE AGGREGATE logging_agg_strict_initcond (anyelement) (stype = TEXT, sfunc = logging_sfunc_strict, mstype = TEXT, msfunc = logging_msfunc_strict, minvfunc = logging_minvfunc_strict, initcond = 'I', minitcond = 'MI'); SELECT CAST(p AS TEXT) || ',' || CAST(i AS TEXT) || ':' || COALESCE(CAST(v AS TEXT), 'NULL') AS row, logging_agg_nonstrict(v) OVER wnd AS nstrict, logging_agg_nonstrict_initcond(v) OVER wnd AS nstrict_init, logging_agg_strict(CAST(v AS TEXT)) OVER wnd AS strict, logging_agg_strict_initcond(v) OVER wnd AS strict_init FROM (VALUES (1, 1, NULL), (1, 2, 'a'), (1, 3, 'b'), (1, 4, NULL), (1, 5, NULL), (1, 6, 'c'), (2, 1, NULL), (2, 2, 'x'), (3, 1, 'z')) AS t(p, i, v) WINDOW wnd AS (PARTITION BY p ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY p, i; SELECT CAST(p AS TEXT) || ',' || CAST(i AS TEXT) || ':' || CASE WHEN f THEN COALESCE(CAST(v AS TEXT), 'NULL') ELSE '-' END AS row, logging_agg_nonstrict(v) FILTER (WHERE f) OVER wnd AS nstrict_filt, logging_agg_nonstrict_initcond(v) FILTER (WHERE f) OVER wnd AS nstrict_init_filt, logging_agg_strict(CAST(v AS TEXT)) FILTER (WHERE f) OVER wnd AS strict_filt, logging_agg_strict_initcond(v) FILTER (WHERE f) OVER wnd AS strict_init_filt FROM (VALUES (1, 1, TRUE, NULL), (1, 2, FALSE, 'a'), (1, 3, TRUE, 'b'), (1, 4, FALSE, NULL), (1, 5, FALSE, NULL), (1, 6, FALSE, 'c'), (2, 1, FALSE, NULL), (2, 2, TRUE, 'x'), (3, 1, TRUE, 'z')) AS t(p, i, f, v) WINDOW wnd AS (PARTITION BY p ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY p, i; SELECT CAST(i AS TEXT) || ':' || COALESCE(CAST(v AS TEXT), 'NULL') AS row, logging_agg_strict(CAST(v AS TEXT)) OVER wnd AS inverse, logging_agg_strict(CAST(v AS TEXT) || CASE WHEN random() \u003c 0 THEN '?' ELSE '' END) OVER wnd AS noinverse FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c')) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY i; SELECT CAST(i AS TEXT) || ':' || COALESCE(CAST(v AS TEXT), 'NULL') AS row, logging_agg_strict(CAST(v AS TEXT)) FILTER (WHERE TRUE) OVER wnd AS inverse, logging_agg_strict(CAST(v AS TEXT)) FILTER (WHERE random() \u003e= 0) OVER wnd AS noinverse FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c')) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) ORDER BY i; SELECT logging_agg_strict(CAST(v AS TEXT)) OVER wnd FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c')) AS t(i, v) WINDOW wnd AS (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW) ORDER BY i; CREATE FUNCTION sum_int_randrestart_minvfunc (INT, INT) RETURNS INT AS $$ SELECT CASE WHEN random() \u003c 0.2 THEN NULL ELSE $1 - $2 END $$ LANGUAGE sql STRICT; CREATE AGGREGATE sum_int_randomrestart (INT) (stype = INT, sfunc = int4pl, mstype = INT, msfunc = int4pl, minvfunc = sum_int_randrestart_minvfunc); WITH vs AS (SELECT i, CAST((random() * 100) AS INT) AS v FROM generate_series(1, 100) AS i), sum_following AS (SELECT i, SUM(v) OVER (ORDER BY i DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS s FROM vs) SELECT DISTINCT sum_following.s = sum_int_randomrestart(v) OVER fwd AS eq1, -sum_following.s = sum_int_randomrestart(-v) OVER fwd AS eq2, 100 * 3 + (vs.i - 1) * 3 = length(logging_agg_nonstrict(CAST('' AS TEXT)) OVER fwd) AS eq3 FROM vs INNER JOIN sum_following ON sum_following.i = vs.i WINDOW fwd AS (ORDER BY vs.i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING); SELECT i, AVG(CAST(v AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, AVG(CAST(v AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, AVG(CAST(v AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, AVG(CAST(v AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1.5), (2, 2.5), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, AVG(CAST(v AS INTERVAL)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, '1 sec'), (2, '2 sec'), (3, NULL), (4, NULL)) AS t(i, v); SELECT x, AVG(x) OVER (ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) AS curr_next_avg, AVG(x) OVER (ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_curr_avg, SUM(x) OVER (ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) AS curr_next_sum, SUM(x) OVER (ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_curr_sum FROM (VALUES (CAST(NULL AS INTERVAL)), (CAST('infinity' AS INTERVAL)), ('-2147483648 days -2147483648 months -9223372036854775807 usecs'), (CAST('-infinity' AS INTERVAL)), ('2147483647 days 2147483647 months 9223372036854775806 usecs'), (CAST('infinity' AS INTERVAL)), (CAST('6 days' AS INTERVAL)), (CAST('7 days' AS INTERVAL)), (CAST(NULL AS INTERVAL)), (CAST('-infinity' AS INTERVAL))) AS v(x); SELECT x, AVG(x) OVER (ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM (VALUES (CAST(NULL AS INTERVAL)), (CAST('3 days' AS INTERVAL)), (CAST('infinity' AS TIMESTAMPTZ) - NOW()), (CAST('6 days' AS INTERVAL)), (CAST('-infinity' AS INTERVAL))) AS v(x); SELECT x, SUM(x) OVER (ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM (VALUES (CAST(NULL AS INTERVAL)), (CAST('3 days' AS INTERVAL)), (CAST('infinity' AS TIMESTAMPTZ) - NOW()), (CAST('6 days' AS INTERVAL)), (CAST('-infinity' AS INTERVAL))) AS v(x); SELECT i, SUM(CAST(v AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS money)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, '1.10'), (2, '2.20'), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS INTERVAL)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, '1 sec'), (2, '2 sec'), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1.1), (2, 2.2), (3, NULL), (4, NULL)) AS t(i, v); SELECT SUM(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1.01), (2, 2), (3, 3)) AS v(i, n); SELECT i, COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT var_pop(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_pop(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_pop(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_pop(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_samp(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_samp(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_samp(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT var_samp(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT variance(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT variance(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT variance(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT variance(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT stddev_pop(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_pop(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_pop(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_pop(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_samp(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_samp(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_samp(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev_samp(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (1, NULL), (2, 600), (3, 470), (4, 170), (5, 430), (6, 300)) AS r(i, n); SELECT stddev(CAST(n AS BIGINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (0, NULL), (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT stddev(CAST(n AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (0, NULL), (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT stddev(CAST(n AS SMALLINT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (0, NULL), (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT stddev(CAST(n AS NUMERIC)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM (VALUES (0, NULL), (1, 600), (2, 470), (3, 170), (4, 430), (5, 300)) AS r(i, n); SELECT i, SUM(CAST(v AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS INT)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, NULL), (4, NULL)) AS t(i, v); SELECT i, SUM(CAST(v AS INT)) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM (VALUES (1, 1), (2, 2), (3, 3), (4, 4)) AS t(i, v); SELECT a, b, SUM(b) OVER (ORDER BY a ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) FROM (VALUES (1, CAST(1 AS NUMERIC)), (2, 2), (3, 'NaN'), (4, 3), (5, 4)) AS t(a, b); SELECT to_char(SUM(CAST(n AS FLOAT8)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING), '999999999999999999999D9') FROM (VALUES (1, 1e20), (2, 1)) AS n(i, n); SELECT i, b, bool_and(b) OVER w, bool_or(b) OVER w FROM (VALUES (1, TRUE), (2, TRUE), (3, FALSE), (4, FALSE), (5, TRUE)) AS v(i, b) WINDOW w AS (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING); EXPLAIN (COSTS false) SELECT COUNT(*) OVER (ORDER BY t1.unique1) FROM tenk1 AS t1 INNER JOIN tenk1 AS t2 ON t1.unique1 = t2.tenthous LIMIT 1; EXPLAIN (COSTS false) SELECT COUNT(*) OVER () FROM tenk1 AS t1 INNER JOIN tenk1 AS t2 ON t1.unique1 = t2.tenthous WHERE t2.two = 1 LIMIT 1; EXPLAIN (COSTS false) SELECT COUNT(*) OVER (ORDER BY t1.unique1 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM tenk1 AS t1 INNER JOIN tenk1 AS t2 ON t1.unique1 = t2.tenthous LIMIT 1; EXPLAIN (COSTS false) SELECT COUNT(*) OVER (ORDER BY t1.unique1 ROWS BETWEEN UNBOUNDED PRECEDING AND 10000 FOLLOWING) FROM tenk1 AS t1 INNER JOIN tenk1 AS t2 ON t1.unique1 = t2.tenthous LIMIT 1; SELECT array_agg(i) OVER w FROM generate_series(1, 5) AS i WINDOW w AS (ORDER BY i ROWS BETWEEN (CAST(('foo' \u003c 'foobar') AS INT)) PRECEDING AND CURRENT ROW); CREATE FUNCTION pg_temp.f (group_size BIGINT) RETURNS SETOF INT[] AS $$ SELECT array_agg(s) OVER w FROM generate_series(1,5) s WINDOW w AS (ORDER BY s ROWS BETWEEN CURRENT ROW AND GROUP_SIZE FOLLOWING) $$ LANGUAGE sql STABLE"
  },
  {
    "comment": "window - Statement 303",
    "query": "EXPLAIN (costs off) SELECT * FROM pg_temp.f(2)",
    "expected": "EXPLAIN (COSTS false) SELECT * FROM pg_temp.f(2)"
  },
  {
    "comment": "window - Statement 304",
    "query": "SELECT * FROM pg_temp.f(2)"
  }
]
