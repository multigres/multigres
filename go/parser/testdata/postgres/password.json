[
  {
    "comment": "password - Statement 1",
    "query": "SET password_encryption = 'novalue'"
  },
  {
    "comment": "password - Statement 2",
    "query": "SET password_encryption = true"
  },
  {
    "comment": "password - Statement 3",
    "query": "SET password_encryption = 'md5'"
  },
  {
    "comment": "password - Statement 4",
    "query": "SET password_encryption = 'scram-sha-256'"
  },
  {
    "comment": "password - Statement 5",
    "query": "CREATE ROLE regress_passwd1"
  },
  {
    "comment": "password - Statement 6",
    "query": "ALTER ROLE regress_passwd1 PASSWORD 'role_pwd1'",
    "expected": "ALTER ROLE regress_passwd1 WITH PASSWORD 'role_pwd1'"
  },
  {
    "comment": "password - Statement 7",
    "query": "CREATE ROLE regress_passwd2"
  },
  {
    "comment": "password - Statement 8",
    "query": "ALTER ROLE regress_passwd2 PASSWORD 'role_pwd2'",
    "expected": "ALTER ROLE regress_passwd2 WITH PASSWORD 'role_pwd2'"
  },
  {
    "comment": "password - Statement 9",
    "query": "CREATE ROLE regress_passwd3 PASSWORD 'role_pwd3'"
  },
  {
    "comment": "password - Statement 10",
    "query": "CREATE ROLE regress_passwd4 PASSWORD NULL"
  },
  {
    "comment": "password - Statement 11",
    "query": "SELECT rolname, regexp_replace(rolpassword, '(SCRAM-SHA-256)\\$(\\d+):([a-zA-Z0-9+/=]+)\\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)', '\\1$\\2:\u003csalt\u003e$\u003cstoredkey\u003e:\u003cserverkey\u003e') as rolpassword_masked FROM pg_authid WHERE rolname LIKE 'regress_passwd%' ORDER BY rolname, rolpassword",
    "expected": "SELECT rolname, regexp_replace(rolpassword, '(SCRAM-SHA-256)\\$(\\d+):([a-zA-Z0-9+/=]+)\\$([a-zA-Z0-9+=/]+):([a-zA-Z0-9+/=]+)', '\\1$\\2:\u003csalt\u003e$\u003cstoredkey\u003e:\u003cserverkey\u003e') AS rolpassword_masked FROM pg_authid WHERE rolname LIKE 'regress_passwd%' ORDER BY rolname, rolpassword"
  },
  {
    "comment": "password - Statement 12",
    "query": "ALTER ROLE regress_passwd2 RENAME TO regress_passwd2_new"
  },
  {
    "comment": "password - Statement 13",
    "query": "SELECT rolname, rolpassword FROM pg_authid WHERE rolname LIKE 'regress_passwd2_new' ORDER BY rolname, rolpassword"
  },
  {
    "comment": "password - Statement 14",
    "query": "ALTER ROLE regress_passwd2_new RENAME TO regress_passwd2"
  },
  {
    "comment": "password - Statement 15",
    "query": "ALTER ROLE regress_passwd2 PASSWORD 'foo'",
    "expected": "ALTER ROLE regress_passwd2 WITH PASSWORD 'foo'"
  },
  {
    "comment": "password - Statement 16",
    "query": "ALTER ROLE regress_passwd1 PASSWORD 'md5cd3578025fe2c3d7ed1b9a9b26238b70'",
    "expected": "ALTER ROLE regress_passwd1 WITH PASSWORD 'md5cd3578025fe2c3d7ed1b9a9b26238b70'"
  },
  {
    "comment": "password - Statement 17",
    "query": "ALTER ROLE regress_passwd3 PASSWORD 'SCRAM-SHA-256$4096:VLK4RMaQLCvNtQ==$6YtlR4t69SguDiwFvbVgVZtuz6gpJQQqUMZ7IQJK5yI=:ps75jrHeYU4lXCcXI4O8oIdJ3eO8o2jirjruw9phBTo='",
    "expected": "ALTER ROLE regress_passwd3 WITH PASSWORD 'SCRAM-SHA-256$4096:VLK4RMaQLCvNtQ==$6YtlR4t69SguDiwFvbVgVZtuz6gpJQQqUMZ7IQJK5yI=:ps75jrHeYU4lXCcXI4O8oIdJ3eO8o2jirjruw9phBTo='"
  },
  {
    "comment": "password - Statement 18",
    "query": "ALTER ROLE  regress_passwd4 PASSWORD 'foo'",
    "expected": "ALTER ROLE regress_passwd4 WITH PASSWORD 'foo'"
  },
  {
    "comment": "password - Statement 19",
    "query": "CREATE ROLE regress_passwd5 PASSWORD 'md5e73a4b11df52a6068f8b39f90be36023'"
  },
  {
    "comment": "password - Statement 20",
    "query": "CREATE ROLE regress_passwd6 PASSWORD 'SCRAM-SHA-256$1234'"
  },
  {
    "comment": "password - Statement 21",
    "query": "CREATE ROLE regress_passwd7 PASSWORD 'md5012345678901234567890123456789zz'"
  },
  {
    "comment": "password - Statement 22",
    "query": "CREATE ROLE regress_passwd8 PASSWORD 'md501234567890123456789012345678901zz'"
  },
  {
    "comment": "password - Statement 23",
    "query": "SET scram_iterations = 1024"
  },
  {
    "comment": "password - Statement 24",
    "query": "CREATE ROLE regress_passwd9 PASSWORD 'alterediterationcount'"
  },
  {
    "comment": "password - Statement 25",
    "query": "CREATE ROLE regress_passwd_empty PASSWORD ''"
  },
  {
    "comment": "password - Statement 26",
    "query": "ALTER ROLE regress_passwd_empty PASSWORD 'md585939a5ce845f1a1b620742e3c659e0a'",
    "expected": "ALTER ROLE regress_passwd_empty WITH PASSWORD 'md585939a5ce845f1a1b620742e3c659e0a'"
  },
  {
    "comment": "password - Statement 27",
    "query": "ALTER ROLE regress_passwd_empty PASSWORD 'SCRAM-SHA-256$4096:hpFyHTUsSWcR7O9P$LgZFIt6Oqdo27ZFKbZ2nV+vtnYM995pDh9ca6WSi120=:qVV5NeluNfUPkwm7Vqat25RjSPLkGeoZBQs6wVv+um4='",
    "expected": "ALTER ROLE regress_passwd_empty WITH PASSWORD 'SCRAM-SHA-256$4096:hpFyHTUsSWcR7O9P$LgZFIt6Oqdo27ZFKbZ2nV+vtnYM995pDh9ca6WSi120=:qVV5NeluNfUPkwm7Vqat25RjSPLkGeoZBQs6wVv+um4='"
  },
  {
    "comment": "password - Statement 28",
    "query": "SELECT rolpassword FROM pg_authid WHERE rolname='regress_passwd_empty'",
    "expected": "SELECT rolpassword FROM pg_authid WHERE rolname = 'regress_passwd_empty'"
  },
  {
    "comment": "password - Statement 29",
    "query": "CREATE ROLE regress_passwd_sha_len0 PASSWORD 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI='"
  },
  {
    "comment": "password - Statement 30",
    "query": "CREATE ROLE regress_passwd_sha_len1 PASSWORD 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96RqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZI='"
  },
  {
    "comment": "password - Statement 31",
    "query": "CREATE ROLE regress_passwd_sha_len2 PASSWORD 'SCRAM-SHA-256$4096:A6xHKoH/494E941doaPOYg==$Ky+A30sewHIH3VHQLRN9vYsuzlgNyGNKCh37dy96Rqw=:COPdlNiIkrsacU5QoxydEuOH6e/KfiipeETb/bPw8ZIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA='"
  },
  {
    "comment": "password - Statement 32",
    "query": "SELECT rolname, rolpassword not like '%A6xHKoH/494E941doaPOYg==%' as is_rolpassword_rehashed FROM pg_authid WHERE rolname LIKE 'regress_passwd_sha_len%' ORDER BY rolname",
    "expected": "SELECT rolname, rolpassword LIKE '%A6xHKoH/494E941doaPOYg==%' AS is_rolpassword_rehashed FROM pg_authid WHERE rolname LIKE 'regress_passwd_sha_len%' ORDER BY rolname"
  },
  {
    "comment": "password - Statement 33",
    "query": "DROP ROLE regress_passwd1"
  },
  {
    "comment": "password - Statement 34",
    "query": "DROP ROLE regress_passwd2"
  },
  {
    "comment": "password - Statement 35",
    "query": "DROP ROLE regress_passwd3"
  },
  {
    "comment": "password - Statement 36",
    "query": "DROP ROLE regress_passwd4"
  },
  {
    "comment": "password - Statement 37",
    "query": "DROP ROLE regress_passwd5"
  },
  {
    "comment": "password - Statement 38",
    "query": "DROP ROLE regress_passwd6"
  },
  {
    "comment": "password - Statement 39",
    "query": "DROP ROLE regress_passwd7"
  },
  {
    "comment": "password - Statement 40",
    "query": "DROP ROLE regress_passwd8"
  },
  {
    "comment": "password - Statement 41",
    "query": "DROP ROLE regress_passwd9"
  },
  {
    "comment": "password - Statement 42",
    "query": "DROP ROLE regress_passwd_empty"
  },
  {
    "comment": "password - Statement 43",
    "query": "DROP ROLE regress_passwd_sha_len0"
  },
  {
    "comment": "password - Statement 44",
    "query": "DROP ROLE regress_passwd_sha_len1"
  },
  {
    "comment": "password - Statement 45",
    "query": "DROP ROLE regress_passwd_sha_len2"
  },
  {
    "comment": "password - Statement 46",
    "query": "SELECT rolname, rolpassword FROM pg_authid WHERE rolname LIKE 'regress_passwd%' ORDER BY rolname, rolpassword"
  }
]
