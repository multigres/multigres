[global]
log-path={{.LogPath}}
spool-path={{.SpoolPath}}
lock-path={{.LockPath}}
archive-async=n
archive-copy=y
compress-type=zst
expire-auto=n
link-all=y
log-level-console=info
log-level-file=detail
log-subprocess=y
resume=n
start-fast=y
process-max=8

tls-server-cert-file={{.ServerCertFile}}
tls-server-key-file={{.ServerKeyFile}}
tls-server-ca-file={{.ServerCAFile}}
tls-server-address=0.0.0.0
tls-server-port={{.ServerPort}}
{{- range .ServerAuths}}
tls-server-auth={{.}}
{{- end}}

{{- if .RepoCredentials}}
{{- range $key, $value := .RepoCredentials}}
{{$key}}={{$value}}
{{- end}}
{{- end}}

[multigres]
{{range $key, $value := .RepoConfig}}{{$key}}={{$value}}
{{end}}
pg1-socket-path={{.Pg1SocketPath}}
pg1-port={{.Pg1Port}}
pg1-path={{.Pg1Path}}
pg1-user=postgres
pg1-database=postgres

# pg2 configuration is not included in this template because it varies by backup.
# For replica backups, multipooler passes pg2 parameters (--pg2-host, --pg2-port,
# --pg2-host-type=tls) as CLI arguments to enable backup from primary via TLS server.
# Primary backups don't need pg2 - pgBackRest does local backup from pg1.
